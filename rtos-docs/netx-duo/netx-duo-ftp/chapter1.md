---
title: 第 1 章 - Azure RTOS NetX Duo FTP の概要
description: ファイル転送プロトコル (FTP) は、ファイル転送用に設計されたプロトコルです。
author: philmea
ms.author: philmea
ms.date: 07/14/2020
ms.topic: article
ms.service: rtos
ms.openlocfilehash: 1d56b20b1c7d719d1b7d9c8c5b2fe234d5577da3
ms.sourcegitcommit: e3d42e1f2920ec9cb002634b542bc20754f9544e
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 03/22/2021
ms.locfileid: "104810802"
---
# <a name="chapter-1---introduction-to-azure-rtos-netx-duo-ftp"></a><span data-ttu-id="7a5b8-103">第 1 章 - Azure RTOS NetX Duo FTP の概要</span><span class="sxs-lookup"><span data-stu-id="7a5b8-103">Chapter 1 - Introduction to Azure RTOS NetX Duo FTP</span></span>

<span data-ttu-id="7a5b8-104">ファイル転送プロトコル (FTP) は、ファイル転送用に設計されたプロトコルです。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-104">The File Transfer Protocol (FTP) is a protocol designed for file transfers.</span></span> <span data-ttu-id="7a5b8-105">FTP では、信頼性の高い伝送制御プロトコル (TCP) サービスを利用して、ファイル転送機能を実行します。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-105">FTP utilizes reliable Transmission Control Protocol (TCP) services to perform its file transfer function.</span></span> <span data-ttu-id="7a5b8-106">そのため、FTP は信頼性の高いファイル転送プロトコルです。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-106">Because of this, FTP is a highly reliable file transfer protocol.</span></span> <span data-ttu-id="7a5b8-107">また、FTP は高パフォーマンスです。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-107">FTP is also high-performance.</span></span> <span data-ttu-id="7a5b8-108">実際の FTP ファイル転送は、専用の FTP 接続で実行されます。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-108">The actual FTP file transfer is performed on a dedicated FTP connection.</span></span> <span data-ttu-id="7a5b8-109">NetX Duo FTP は、IPv4 と IPv6 の両方のネットワークに対応しています。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-109">NetX Duo FTP accommodates both IPv4 and IPv6 networks.</span></span> <span data-ttu-id="7a5b8-110">IPv6 によって FTP プロトコルが直接変更されることはありませんが、IPv6 に対応するために元の NetX FTP API にいくつかの変更が必要となります。これについては、このドキュメントで説明します。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-110">IPv6 does not directly change the FTP protocol, although some changes in the original NetX FTP API are necessary to accommodate IPv6 and will be described in this document.</span></span>

## <a name="ftp-requirements"></a><span data-ttu-id="7a5b8-111">FTP の要件</span><span class="sxs-lookup"><span data-stu-id="7a5b8-111">FTP Requirements</span></span>

<span data-ttu-id="7a5b8-112">NetX FTP パッケージを正しく機能させるには、NetX Duo が必要です。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-112">In order to function properly, the NetX FTP package requires NetX Duo.</span></span> <span data-ttu-id="7a5b8-113">ホスト アプリケーションでは、NetX サービスと定期的なタスクを実行するための IP インスタンスを作成する必要があります。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-113">The host application must create an IP instance for running NetX services and periodic tasks.</span></span> <span data-ttu-id="7a5b8-114">FTP ホスト アプリケーションを IPv6 ネットワーク経由で実行する場合は、IP タスクで IPv6 と ICMPv6 を有効にする必要があります。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-114">If running the FTP host application over an IPv6 network, IPv6, and ICMPv6 must be enabled on the IP task.</span></span> <span data-ttu-id="7a5b8-115">また、IPv6 と IPv4 のどちらのネットワークでも、TCP を有効にする必要があります。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-115">TCP must be also enabled for either IPv6 or IPv4 networks.</span></span> <span data-ttu-id="7a5b8-116">IPv6 ホスト アプリケーションでは、IPv6 API または DHCPv6、あるいはその両方を使用して、リンクローカルおよびグローバル IPv6 アドレスを設定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-116">The IPv6 host application must set its linklocal and global IPv6 address using the IPv6 API and/or DHCPv6.</span></span> <span data-ttu-id="7a5b8-117">**第 2 章** の「簡単なシステムの例」セクションのデモ プログラムでこの方法が示されています。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-117">A demo program in section “Small Example System” in **Chapter 2** demonstrates how this is done.</span></span>

<span data-ttu-id="7a5b8-118">FTP サーバーとクライアントは、FileX 組み込みファイル システムとも連携するように設計されています。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-118">The FTP Server and Client are also designed to work with the FileX embedded file system.</span></span> <span data-ttu-id="7a5b8-119">FileX が使用できない場合、ホスト開発者は、filex_stub.h に示されているガイドラインに従って、このファイルに記載されている各サービスを定義することによって、独自のファイル システムを実装または代用できます。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-119">If FileX is not available, the host developer can implement or substitute their own file system along the guidelines suggested in filex_stub.h by defining each of the services listed in that file.</span></span> <span data-ttu-id="7a5b8-120">これについては、このガイドの後のセクションで説明します。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-120">This is discussed in later sections of this guide.</span></span>

<span data-ttu-id="7a5b8-121">NetX FTP パッケージの FTP クライアント部分には、これ以上の要件はありません。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-121">The FTP Client portion of the NetX FTP package has no further requirements.</span></span>

<span data-ttu-id="7a5b8-122">NetX FTP パッケージの FTP サーバー部分には、追加要件がいくつかあります。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-122">The FTP Server portion of the NetX FTP package has several additional requirements.</span></span> <span data-ttu-id="7a5b8-123">最も重要なのは、TCP の "*ウェルノウン ポート 21*" (すべてのクライアント FTP コマンド要求を処理) と、"*ウェルノウン ポート 20*" (すべてのクライアント FTP データ転送を処理) への完全なアクセス権が必要であることです。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-123">First, it requires complete access to TCP *well-known port 21* for handling all Client FTP command requests and *well-known port 20* for handling all Client FTP data transfers.</span></span>

## <a name="ftp-constraints"></a><span data-ttu-id="7a5b8-124">FTP の制約</span><span class="sxs-lookup"><span data-stu-id="7a5b8-124">FTP Constraints</span></span>

<span data-ttu-id="7a5b8-125">FTP 標準には、ファイル データの表現に関する多くのオプションがあります。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-125">The FTP standard has many options regarding the representation of file data.</span></span> <span data-ttu-id="7a5b8-126">NetX FTP は、ls -al などのスイッチ オプションを実装していません。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-126">NetX FTP does not implement switch options e.g. ls –al.</span></span> <span data-ttu-id="7a5b8-127">NetX FTP サーバーでは、連続したパケットではなく、1 つのパケットで要求とその引数を受信することを想定しています。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-127">NetX FTP Server expects to receive requests and their arguments in a single packet rather than consecutive packets.</span></span>

<span data-ttu-id="7a5b8-128">UNIX の実装と同様に、NetX FTP には次のファイル形式の制約があります。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-128">Similar to UNIX implementations, NetX FTP assumes the following file format constraints:</span></span>

- <span data-ttu-id="7a5b8-129">ファイルの種類: **バイナリ**</span><span class="sxs-lookup"><span data-stu-id="7a5b8-129">File Type: **Binary**</span></span>
- <span data-ttu-id="7a5b8-130">ファイル形式: **onprint のみ**</span><span class="sxs-lookup"><span data-stu-id="7a5b8-130">File Format: **Nonprint Only**</span></span>
- <span data-ttu-id="7a5b8-131">ファイル構造: **ファイル構造のみ**</span><span class="sxs-lookup"><span data-stu-id="7a5b8-131">File Structure: **File Structure Only**</span></span>

## <a name="ftp-file-names"></a><span data-ttu-id="7a5b8-132">FTP ファイル名</span><span class="sxs-lookup"><span data-stu-id="7a5b8-132">FTP File Names</span></span>

<span data-ttu-id="7a5b8-133">FTP ファイル名は、ターゲット ファイル システム (通常は FileX) の形式である必要があります。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-133">FTP file names should be in the format of the target file system (usually FileX).</span></span> <span data-ttu-id="7a5b8-134">これらは、必要に応じて完全なパス情報を含む、NULL 終端 ASCII 文字列である必要があります。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-134">They should be NULL terminated ASCII strings, with full path information if necessary.</span></span> <span data-ttu-id="7a5b8-135">NetX FTP 実装では、FTP ファイル名のサイズに特に制限はありません。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-135">There is no specified limit for the size of FTP file names in the NetX FTP implementation.</span></span> <span data-ttu-id="7a5b8-136">ただし、パケット プールのペイロード サイズは、最大のパスやファイル名に対応できる必要があります。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-136">However, the packet pool payload size should be able to accommodate the maximum path and/or file name.</span></span>

## <a name="ftp-client-commands"></a><span data-ttu-id="7a5b8-137">FTP クライアント コマンド</span><span class="sxs-lookup"><span data-stu-id="7a5b8-137">FTP Client Commands</span></span>

<span data-ttu-id="7a5b8-138">FTP には、接続を開き、ファイルおよびディレクトリ操作を実行するための単純なメカニズムがあります。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-138">The FTP has a simple mechanism for opening connections and performing file and directory operations.</span></span> <span data-ttu-id="7a5b8-139">基本的には、TCP の "*ウェルノウン ポート 21*" で接続が正常に確立された後にクライアントによって発行される一連の標準の FTP コマンドがあります。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-139">There is basically a set of standard FTP commands that are issued by the Client after a connection has been successfully established on the TCP *well-known port 21*.</span></span> <span data-ttu-id="7a5b8-140">基本的な FTP コマンドの一部を次に示します。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-140">The following shows some of the basic FTP commands.</span></span> <span data-ttu-id="7a5b8-141">FTP が IPv6 で実行される場合の唯一の違いは、PORT コマンドが EPRT コマンドに置き換えられることです。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-141">Note that the only difference when FTP runs over IPv6 is that the PORT command is replaced with the EPRT command:</span></span>

- <span data-ttu-id="7a5b8-142">CWD パス: "*作業ディレクトリを変更する*"</span><span class="sxs-lookup"><span data-stu-id="7a5b8-142">CWD path *Change working directory*</span></span>
- <span data-ttu-id="7a5b8-143">DELE ファイル名: "*指定したファイル名を削除する*"</span><span class="sxs-lookup"><span data-stu-id="7a5b8-143">DELE filename *Delete specified file name*</span></span>
- <span data-ttu-id="7a5b8-144">EPRT IP アドレス, ポート: "*IPv6 アドレスとクライアント データ ポートを指定する*"</span><span class="sxs-lookup"><span data-stu-id="7a5b8-144">EPRT ip_address, port *Provide IPv6 address and Client data port*</span></span>
- <span data-ttu-id="7a5b8-145">EPSV: "*IPv6 のパッシブ転送モードを要求する*"</span><span class="sxs-lookup"><span data-stu-id="7a5b8-145">EPSV *Request passive transfer mode for IPv6*</span></span>
- <span data-ttu-id="7a5b8-146">LIST ディレクトリ: "*ディレクトリの一覧を取得する*"</span><span class="sxs-lookup"><span data-stu-id="7a5b8-146">LIST directory *Get directory listing*</span></span>
- <span data-ttu-id="7a5b8-147">MKD ディレクトリ: "*新しいディレクトリを作成する*"</span><span class="sxs-lookup"><span data-stu-id="7a5b8-147">MKD directory *Make new directory*</span></span>
- <span data-ttu-id="7a5b8-148">NLST ディレクトリ: "*ディレクトリの一覧を取得する*"</span><span class="sxs-lookup"><span data-stu-id="7a5b8-148">NLST directory *Get directory listing*</span></span>
- <span data-ttu-id="7a5b8-149">NOOP: "*操作なし、成功を返す*"</span><span class="sxs-lookup"><span data-stu-id="7a5b8-149">NOOP *No operation, returns success*</span></span>
- <span data-ttu-id="7a5b8-150">PASS パスワード: "*ログインのパスワードを指定する*"</span><span class="sxs-lookup"><span data-stu-id="7a5b8-150">PASS password *Provide password for login*</span></span>
- <span data-ttu-id="7a5b8-151">PASV: "*IPv4 のパッシブ転送モードを要求する*"</span><span class="sxs-lookup"><span data-stu-id="7a5b8-151">PASV *Request passive transfer mode for IPv4*</span></span>
- <span data-ttu-id="7a5b8-152">PORT IP アドレス, ポート: "*IP アドレスとクライアント データ ポートを指定する*"</span><span class="sxs-lookup"><span data-stu-id="7a5b8-152">PORT ip_address,port *Provide IP address and Client data port*</span></span>
- <span data-ttu-id="7a5b8-153">PWD パス: "*現在のディレクトリ パスを選択する*"</span><span class="sxs-lookup"><span data-stu-id="7a5b8-153">PWD path *Pickup current directory path*</span></span>
- <span data-ttu-id="7a5b8-154">QUIT: "*クライアント接続を終了する*"</span><span class="sxs-lookup"><span data-stu-id="7a5b8-154">QUIT *Terminate Client connection*</span></span>
- <span data-ttu-id="7a5b8-155">RETR ファイル名: "*指定したファイルを読み取る*"</span><span class="sxs-lookup"><span data-stu-id="7a5b8-155">RETR filename *Read specified file*</span></span>
- <span data-ttu-id="7a5b8-156">RMD ディレクトリ: "*指定したディレクトリを削除する*"</span><span class="sxs-lookup"><span data-stu-id="7a5b8-156">RMD directory *Delete specified directory*</span></span>
- <span data-ttu-id="7a5b8-157">RNFR 古いファイル名: "*名前を変更するファイルを指定する*"</span><span class="sxs-lookup"><span data-stu-id="7a5b8-157">RNFR oldfilename *Specify file to rename*</span></span>
- <span data-ttu-id="7a5b8-158">RNTO 新しいファイル名: "*ファイル名を指定したファイル名に変更する*"</span><span class="sxs-lookup"><span data-stu-id="7a5b8-158">RNTO newfilename *Rename file to supplied file name*</span></span>
- <span data-ttu-id="7a5b8-159">STOR ファイル名: "*指定したファイルを書き込む*"</span><span class="sxs-lookup"><span data-stu-id="7a5b8-159">STOR filename *Write specified file*</span></span>
- <span data-ttu-id="7a5b8-160">TYPE I: "*バイナリ ファイル イメージを選択する*"</span><span class="sxs-lookup"><span data-stu-id="7a5b8-160">TYPE I *Select binary file image*</span></span>
- <span data-ttu-id="7a5b8-161">USER ユーザー名: "*ログインのユーザー名を指定する*"</span><span class="sxs-lookup"><span data-stu-id="7a5b8-161">USER username *Provide username for login*</span></span>

<span data-ttu-id="7a5b8-162">これらの ASCII コマンドは、FTP サーバーで FTP 操作を実行するために、NetX FTP クライアント ソフトウェアによって内部的に使用されます。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-162">These ASCII commands are used internally by the NetX FTP Client software to perform FTP operations with the FTP Server.</span></span>

## <a name="ftp-server-responses"></a><span data-ttu-id="7a5b8-163">FTP サーバーの応答</span><span class="sxs-lookup"><span data-stu-id="7a5b8-163">FTP Server Responses</span></span>

<span data-ttu-id="7a5b8-164">FTP サーバーは、クライアント要求を処理すると、ASCII でコード化された 3 桁の応答に続いて、任意の ASCII テキストを返します。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-164">Once the FTP Server processes the Client request, it returns a 3-digit coded response in ASCII followed by optional ASCII text.</span></span> <span data-ttu-id="7a5b8-165">この数値の応答は、操作が成功したか失敗したかを判断するために、FTP クライアント ソフトウェアによって使用されます。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-165">The numeric response is used by the FTP Client software to determine whether the operation succeeded or failed.</span></span> <span data-ttu-id="7a5b8-166">クライアント要求に対するさまざまな FTP サーバー応答を次に示します。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-166">The following list shows various FTP Server responses to Client requests:</span></span>

<span data-ttu-id="7a5b8-167">**最初の数値フィールドの意味**</span><span class="sxs-lookup"><span data-stu-id="7a5b8-167">**First Numeric Field Meaning**</span></span>

- <span data-ttu-id="7a5b8-168">1xx: "*肯定的な準備状態 - さらに別の応答が返されます*"。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-168">1xx *Positive preliminary status – another reply coming*.</span></span>
- <span data-ttu-id="7a5b8-169">2xx: "*肯定的な完了状態*"。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-169">2xx *Positive completion status*.</span></span>
- <span data-ttu-id="7a5b8-170">3xx: "*肯定的な準備状態 - 別のコマンドを送信する必要があります*"。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-170">3xx *Positive preliminary status – another command must be sent*.</span></span>
- <span data-ttu-id="7a5b8-171">4xx: "*一時的なエラー状態*"。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-171">4xx *Temporary error condition*.</span></span>
- <span data-ttu-id="7a5b8-172">5xx: "*エラー状態。"*</span><span class="sxs-lookup"><span data-stu-id="7a5b8-172">5xx *Error condition.*</span></span>

<span data-ttu-id="7a5b8-173">**2 番目の数値フィールドの意味**</span><span class="sxs-lookup"><span data-stu-id="7a5b8-173">**Second Numeric Field Meaning**</span></span>

- <span data-ttu-id="7a5b8-174">x0x: "*コマンドの構文エラー*"。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-174">x0x *Syntax error in command*.</span></span>
- <span data-ttu-id="7a5b8-175">x1x: "*情報メッセージ*"。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-175">x1x *Informational message*.</span></span>
- <span data-ttu-id="7a5b8-176">x2x: "*接続関連*"。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-176">x2x *Connection related*.</span></span>
- <span data-ttu-id="7a5b8-177">x3x: "*認証関連*"。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-177">x3x *Authentication related*.</span></span>
- <span data-ttu-id="7a5b8-178">x4x: "*未指定*"。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-178">x4x *Unspecified*.</span></span>
- <span data-ttu-id="7a5b8-179">x5x: "*ファイル システム関連*"。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-179">x5x *File system related*.</span></span>

<span data-ttu-id="7a5b8-180">たとえば、クライアントが QUIT コマンドで FTP 接続の切断を要求すると、通常はサーバーから "221" コードで応答が返されます (切断が成功した場合)。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-180">For example, a Client request to disconnect an FTP connection with the QUIT command will typically be responded with a “221” code from the Server – if the disconnect is successful.</span></span>

## <a name="ftp-passive-transfer-mode"></a><span data-ttu-id="7a5b8-181">FTP パッシブ転送モード</span><span class="sxs-lookup"><span data-stu-id="7a5b8-181">FTP Passive Transfer Mode</span></span>

<span data-ttu-id="7a5b8-182">既定では、NetX Duo FTP クライアントではアクティブ転送モードを使用して、データ ソケットを介して FTP サーバーとデータを交換します。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-182">By default, the NetX Duo FTP Client uses the active transport mode to exchange data over the data socket with the FTP server.</span></span> <span data-ttu-id="7a5b8-183">この配置の問題は、FTP サーバーが接続する TCP サーバー ソケットを FTP クライアントが開く必要があることです。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-183">The problem with this arrangement is that it requires the FTP Client to open a TCP server socket for the FTP Server to connect to.</span></span> <span data-ttu-id="7a5b8-184">これはセキュリティ リスクをもたらす可能性があり、クライアント ファイアウォールによってブロックされる場合があります。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-184">This represents a possible security risk and may be blocked by the Client firewall.</span></span> <span data-ttu-id="7a5b8-185">パッシブ転送モードは、データ接続で FTP サーバーが TCP サーバー ソケットを作成するという点で、アクティブ転送モードとは異なります。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-185">Passive transfer mode differs from active transport mode by having the FTP server create the TCP server socket on the data connection.</span></span> <span data-ttu-id="7a5b8-186">これにより、(FTP クライアントの) セキュリティ リスクが排除されます。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-186">This eliminates the security risk (for the FTP Client).</span></span>

<span data-ttu-id="7a5b8-187">パッシブ データ転送を有効にするには、以前に作成された FTP クライアントに対して、2 番目の引数を NX_TRUE に設定した *nx_ftp_client_passive_mode_set* をアプリケーションで呼び出します。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-187">To enable passive data transfer, the application calls *nx_ftp_client_passive_mode_set* on a previously created FTP Client with the second argument set to NX_TRUE.</span></span> <span data-ttu-id="7a5b8-188">その後、データを転送するための後続の NetX Duo FTP クライアント サービス (NLST、RETR、STOR) は、すべてパッシブ転送モードで試行されます。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-188">Thereafter, all subsequent NetX Duo FTP Client services for transferring data (NLST, RETR, STOR) are attempted in the passive transport mode.</span></span>

<span data-ttu-id="7a5b8-189">FTP クライアントは、最初にパッシブ コマンド (引数なし) を送信します。IPv4 の場合は PASV コマンド、IPv6 の場合は EPSV コマンドです。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-189">The FTP Client first sends the passive command (no arguments), PASV command for IPv4 or EPSV command for IPv6.</span></span> <span data-ttu-id="7a5b8-190">FTP サーバーがこの要求をサポートしている場合、PASV では 227 "OK" 応答、EPSV では 229 "OK" 応答が返されます。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-190">If the FTP server supports this request it will return the 227 “OK” response for PASV, and 229 “OK” response for EPSV.</span></span> <span data-ttu-id="7a5b8-191">次に、クライアントが RETR などの要求を送信します。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-191">Then the Client sends the request e.g. RETR.</span></span> <span data-ttu-id="7a5b8-192">サーバーがパッシブ転送モードを拒否した場合、NetX Duo FTP クライアント サービスはエラー状態を返します。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-192">If the server refuses passive transfer mode, the NetX Duo FTP Client service returns an error status.</span></span>

<span data-ttu-id="7a5b8-193">パッシブ転送モードを無効にし、アクティブ転送モードに戻すには、2 番目の引数を NX_FALSE に設定した *nx_ftp_client_passive_mode_set* をアプリケーションで呼び出します。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-193">To disable passive transport mode and return to active transport mode, the application calls *nx_ftp_client_passive_mode_set* with the second argument set to NX_FALSE.</span></span>

## <a name="ftp-communication"></a><span data-ttu-id="7a5b8-194">FTP 通信</span><span class="sxs-lookup"><span data-stu-id="7a5b8-194">FTP Communication</span></span>

<span data-ttu-id="7a5b8-195">FTP サーバーでは、"*ウェルノウン TCP ポート 21*" を使用してクライアント要求を処理します。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-195">The FTP Server utilizes the *well-known TCP port 21* to field Client requests.</span></span> <span data-ttu-id="7a5b8-196">FTP クライアントでは、使用可能な任意の TCP ポートを使用できます。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-196">FTP Clients may use any available TCP port.</span></span> <span data-ttu-id="7a5b8-197">FTP イベントの一般的なシーケンスは次のとおりです。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-197">The general sequence of FTP events is as follows:</span></span>

<span data-ttu-id="7a5b8-198">**FTP ファイル読み取り要求**:</span><span class="sxs-lookup"><span data-stu-id="7a5b8-198">**FTP Read File Requests**:</span></span>

1. <span data-ttu-id="7a5b8-199">クライアントがサーバー ポート 21 への TCP 接続を発行します。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-199">Client issues TCP connect to Server port 21.</span></span>
1. <span data-ttu-id="7a5b8-200">サーバーが "220" 応答を送信して成功を通知します。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-200">Server sends “220” response to signal success.</span></span>
1. <span data-ttu-id="7a5b8-201">クライアントが "ユーザー名" を含む "USER" メッセージを送信します。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-201">Client sends “USER” message with “username.”</span></span>
1. <span data-ttu-id="7a5b8-202">サーバーが "331" 応答を送信して成功を通知します。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-202">Server sends “331” response to signal success.</span></span>
1. <span data-ttu-id="7a5b8-203">クライアントが "パスワード" を含む "PASS" メッセージを送信します。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-203">Client sends “PASS” message with “password.”</span></span>
1. <span data-ttu-id="7a5b8-204">サーバーが "230" 応答を送信して成功を通知します。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-204">Server sends “230” response to signal success.</span></span>
1. <span data-ttu-id="7a5b8-205">クライアントがバイナリ転送用の "TYPE I" メッセージを送信します。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-205">Client sends “TYPE I” message for binary transfer.</span></span>
1. <span data-ttu-id="7a5b8-206">サーバーが "200" 応答を送信して成功を通知します。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-206">Server sends “200” response to signal success.</span></span>
1. <span data-ttu-id="7a5b8-207">"*IPv4 アプリケーション*": クライアントが、IP アドレスとポートを含む "PORT" メッセージを送信します。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-207">*IPv4 applications*: Client sends “PORT” message with IP address and port.</span></span><br /><span data-ttu-id="7a5b8-208">"*IPv6 アプリケーション*": クライアントが、IP アドレスとポートを含む "EPRT" メッセージを送信します。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-208">*IPv6 applications*: Client sends “EPRT” message with IP address and port.</span></span>
1. <span data-ttu-id="7a5b8-209">サーバーが "200" 応答を送信して成功を通知します。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-209">Server sends “200” response to signal success.</span></span>
1. <span data-ttu-id="7a5b8-210">クライアントが、読み取るファイル名を含む "RETR" メッセージを送信します。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-210">Client sends “RETR” message with file name to read.</span></span>
1. <span data-ttu-id="7a5b8-211">サーバーがデータ ソケットを作成し、"PORT" コマンドで指定されたクライアント データ ポートに接続します。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-211">Server creates data socket and connects with client data port specified in the “PORT” command.</span></span>
1. <span data-ttu-id="7a5b8-212">サーバーが "125" 応答を送信して、ファイルの読み取りが開始されたことを通知します。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-212">Server sends “125” response to signal file read has started.</span></span>
1. <span data-ttu-id="7a5b8-213">サーバーが、データ接続を介してファイルの内容を送信します。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-213">Server sends contents of file through the data connection.</span></span> <span data-ttu-id="7a5b8-214">ファイルが完全に転送されるまで、このプロセスが続行されます。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-214">This process continues until file is completely transferred.</span></span>
1. <span data-ttu-id="7a5b8-215">完了すると、サーバーはデータ接続を切断します。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-215">When finished, Server disconnects data connection.</span></span>
1. <span data-ttu-id="7a5b8-216">サーバーが "250" 応答を送信して、ファイルの読み取りが成功したことを通知します。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-216">Server sends “250” response to signal file read is successful.</span></span>
1. <span data-ttu-id="7a5b8-217">クライアントが "QUIT" を送信して FTP 接続を終了します。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-217">Client sends “QUIT” to terminate FTP connection.</span></span>
1. <span data-ttu-id="7a5b8-218">サーバーが "221" 応答を送信して、切断が成功したことを通知します。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-218">Server sends “221” response to signal disconnect is successful.</span></span>
1. <span data-ttu-id="7a5b8-219">サーバーが FTP 接続を切断します。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-219">Server disconnects FTP connection.</span></span>

<span data-ttu-id="7a5b8-220">前述のように、IPv4 で実行される FTP と IPv6 で実行される FTP の唯一の違いは、IPv6 では PORT コマンドが EPRT コマンドに置き換えられていることです。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-220">As mentioned previously, the only difference between FTP running over IPv4 and</span></span>

IPv6 is the PORT command is replaced with the EPRT command for IPv6

<span data-ttu-id="7a5b8-222">FTP クライアントがパッシブ転送モードで読み取り要求を行う場合、コマンド シーケンスは次のようになります (**太字** の行は、アクティブ転送モードとは異なる手順を示しています)。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-222">If the FTP Client makes a read request in the passive transfer mode, the command sequence is as follows (**bolded** lines indicates a different step from active transfer mode):</span></span>

1. <span data-ttu-id="7a5b8-223">クライアントがサーバー ポート 21 への TCP 接続を発行します。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-223">Client issues TCP connect to Server port 21.</span></span>
1. <span data-ttu-id="7a5b8-224">サーバーが "220" 応答を送信して成功を通知します。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-224">Server sends “220” response to signal success.</span></span>
1. <span data-ttu-id="7a5b8-225">クライアントが "ユーザー名" を含む "USER" メッセージを送信します。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-225">Client sends “USER” message with “username.”</span></span>
1. <span data-ttu-id="7a5b8-226">サーバーが "331" 応答を送信して成功を通知します。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-226">Server sends “331” response to signal success.</span></span>
1. <span data-ttu-id="7a5b8-227">クライアントが "パスワード" を含む "PASS" メッセージを送信します。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-227">Client sends “PASS” message with “password.”</span></span>
1. <span data-ttu-id="7a5b8-228">サーバーが "230" 応答を送信して成功を通知します。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-228">Server sends “230” response to signal success.</span></span>
1. <span data-ttu-id="7a5b8-229">クライアントがバイナリ転送用の "TYPE I" メッセージを送信します。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-229">Client sends “TYPE I” message for binary transfer.</span></span>
1. <span data-ttu-id="7a5b8-230">サーバーが "200" 応答を送信して成功を通知します。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-230">Server sends “200” response to signal success.</span></span>
1. <span data-ttu-id="7a5b8-231">**"*IPv4 アプリケーション:"\* クライアントが "PASV" メッセージを送信します。*\*</span><span class="sxs-lookup"><span data-stu-id="7a5b8-231">***IPv4 applications:* Client sends “PASV” message.**</span></span><br /><span data-ttu-id="7a5b8-232">**"_IPv6 アプリケーション:"_ クライアントが "EPSV" メッセージを送信します。**</span><span class="sxs-lookup"><span data-stu-id="7a5b8-232">**_IPv6 applications:_ Client sends “EPSV” message.**</span></span>
1. <span data-ttu-id="7a5b8-233">**"*IPv4 アプリケーション:"\* サーバーが "227" 応答と、クライアントの接続先となる IP アドレスとポートを送信して、成功を通知します。*\*</span><span class="sxs-lookup"><span data-stu-id="7a5b8-233">***IPv4 applications:* Server sends “227” response, and IP address and port for the Client to connect to, to signal success.**</span></span><br /><span data-ttu-id="7a5b8-234">**"_IPv6 アプリケーション:"_ サーバーが "229" 応答と、クライアントの接続先となる IP アドレスとポートを送信して、成功を通知します。**</span><span class="sxs-lookup"><span data-stu-id="7a5b8-234">**_IPv6 applications:_ Server sends “229” response, and IP address and port for the Client to connect to, to signal success.**</span></span>
1. <span data-ttu-id="7a5b8-235">クライアントが、読み取るファイル名を含む "RETR" メッセージを送信します。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-235">Client sends “RETR” message with file name to read.</span></span>
1. <span data-ttu-id="7a5b8-236">**サーバーがデータ サーバー ソケットを作成し、手順 10. の応答で指定したポートを使用して、このソケットでクライアント接続要求をリッスンします。**</span><span class="sxs-lookup"><span data-stu-id="7a5b8-236">**Server creates data server socket and listens for the Client connect request on this socket using the port specified in the response in step 10.**</span></span>
1. <span data-ttu-id="7a5b8-237">**サーバーが制御ソケットで "150" 応答を送信して、ファイルの読み取りが開始されたことを通知します。**</span><span class="sxs-lookup"><span data-stu-id="7a5b8-237">**Server sends “150” response on the control socket to signal file read has started.**</span></span>
1. <span data-ttu-id="7a5b8-238">サーバーが、データ接続を介してファイルの内容を送信します。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-238">Server sends contents of file through the data connection.</span></span> <span data-ttu-id="7a5b8-239">ファイルが完全に転送されるまで、このプロセスが続行されます。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-239">This process continues until file is completely transferred.</span></span>
1. <span data-ttu-id="7a5b8-240">完了すると、サーバーはデータ接続を切断します。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-240">When finished, Server disconnects data connection.</span></span>
1. <span data-ttu-id="7a5b8-241">**サーバーが制御ソケットで "226" 応答を送信して、ファイルの読み取りが成功したことを通知します。**</span><span class="sxs-lookup"><span data-stu-id="7a5b8-241">**Server sends “226” response on the control socket to signal file read is successful.**</span></span>
1. <span data-ttu-id="7a5b8-242">クライアントが "QUIT" を送信して FTP 接続を終了します。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-242">Client sends “QUIT” to terminate FTP connection.</span></span>
1. <span data-ttu-id="7a5b8-243">サーバーが "221" 応答を送信して、切断が成功したことを通知します。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-243">Server sends “221” response to signal disconnect is successful.</span></span>
1. <span data-ttu-id="7a5b8-244">サーバーが FTP 接続を切断します。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-244">Server disconnects FTP connection.</span></span>

<span data-ttu-id="7a5b8-245">**FTP 書き込み要求**:</span><span class="sxs-lookup"><span data-stu-id="7a5b8-245">**FTP Write Requests**:</span></span>

1. <span data-ttu-id="7a5b8-246">クライアントがサーバー ポート 21 への TCP 接続を発行します。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-246">Client issues TCP connect to Server port 21.</span></span>
1. <span data-ttu-id="7a5b8-247">サーバーが "220" 応答を送信して成功を通知します。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-247">Server sends “220” response to signal success.</span></span>
1. <span data-ttu-id="7a5b8-248">クライアントが "ユーザー名" を含む "USER" メッセージを送信します。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-248">Client sends “USER” message with “username.”</span></span>
1. <span data-ttu-id="7a5b8-249">サーバーが "331" 応答を送信して成功を通知します。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-249">Server sends “331” response to signal success.</span></span>
1. <span data-ttu-id="7a5b8-250">クライアントが "パスワード" を含む "PASS" メッセージを送信します。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-250">Client sends “PASS” message with “password.”</span></span>
1. <span data-ttu-id="7a5b8-251">サーバーが "230" 応答を送信して成功を通知します。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-251">Server sends “230” response to signal success.</span></span>
1. <span data-ttu-id="7a5b8-252">クライアントがバイナリ転送用の "TYPE I" メッセージを送信します。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-252">Client sends “TYPE I” message for binary transfer.</span></span>
1. <span data-ttu-id="7a5b8-253">サーバーが "200" 応答を送信して成功を通知します。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-253">Server sends “200” response to signal success.</span></span>
1. <span data-ttu-id="7a5b8-254">"*IPv4 アプリケーション*": クライアントが、IP アドレスとポートを含む "PORT" メッセージを送信します。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-254">*IPv4 applications*: Client sends “PORT” message with IP address and port.</span></span><br /><span data-ttu-id="7a5b8-255">"*IPv6 アプリケーション*": クライアントが、IP アドレスとポートを含む "EPRT" メッセージを送信します。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-255">*IPv6 applications*: Client sends “EPRT” message with IP address and port.</span></span>
1. <span data-ttu-id="7a5b8-256">サーバーが "200" 応答を送信して成功を通知します。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-256">Server sends “200” response to signal success.</span></span>
1. <span data-ttu-id="7a5b8-257">クライアントが、書き込むファイル名を含む "STOR" メッセージを送信します。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-257">Client sends “STOR” message with file name to write.</span></span>
1. <span data-ttu-id="7a5b8-258">サーバーがデータ ソケットを作成し、前の "EPRT" または "PORT" コマンドで指定されたクライアント データ ポートに接続します。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-258">Server creates data socket and connects with client data port specified in the previous “EPRT” or “PORT” command.</span></span>
1. <span data-ttu-id="7a5b8-259">サーバーが "125" 応答を送信して、ファイルの書き込みが開始されたことを通知します。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-259">Server sends “125” response to signal file write has started.</span></span>
1. <span data-ttu-id="7a5b8-260">クライアントが、データ接続を介してファイルの内容を送信します。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-260">Client sends contents of file through the data connection.</span></span> <span data-ttu-id="7a5b8-261">ファイルが完全に転送されるまで、このプロセスが続行されます。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-261">This process continues until file is completely transferred.</span></span>
1. <span data-ttu-id="7a5b8-262">完了すると、クライアントはデータ接続を切断します。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-262">When finished, Client disconnects data connection.</span></span>
1. <span data-ttu-id="7a5b8-263">サーバーが "250" 応答を送信して、ファイルの書き込みが成功したことを通知します。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-263">Server sends “250” response to signal file write is successful.</span></span>
1. <span data-ttu-id="7a5b8-264">クライアントが "QUIT" を送信して FTP 接続を終了します。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-264">Client sends “QUIT” to terminate FTP connection.</span></span>
1. <span data-ttu-id="7a5b8-265">サーバーが "221" 応答を送信して、切断が成功したことを通知します。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-265">Server sends “221” response to signal disconnect is successful.</span></span>
1. <span data-ttu-id="7a5b8-266">サーバーが FTP 接続を切断します。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-266">Server disconnects FTP connection.</span></span>

<span data-ttu-id="7a5b8-267">FTP クライアントがパッシブ転送モードで書き込み要求を行う場合、コマンド シーケンスは次のようになります (**太字** の行は、アクティブ転送モードとは異なる手順を示しています)。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-267">If the FTP Client makes a write request in the passive transfer mode, the command sequence is as follows (**bolded** lines indicates a different step from active transfer mode):</span></span>

1. <span data-ttu-id="7a5b8-268">クライアントがサーバー ポート 21 への TCP 接続を発行します。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-268">Client issues TCP connect to Server port 21.</span></span>
1. <span data-ttu-id="7a5b8-269">サーバーが "220" 応答を送信して成功を通知します。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-269">Server sends “220” response to signal success.</span></span>
1. <span data-ttu-id="7a5b8-270">クライアントが "ユーザー名" を含む "USER" メッセージを送信します。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-270">Client sends “USER” message with “username.”</span></span>
1. <span data-ttu-id="7a5b8-271">サーバーが "331" 応答を送信して成功を通知します。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-271">Server sends “331” response to signal success.</span></span>
1. <span data-ttu-id="7a5b8-272">クライアントが "パスワード" を含む "PASS" メッセージを送信します。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-272">Client sends “PASS” message with “password.”</span></span>
1. <span data-ttu-id="7a5b8-273">サーバーが "230" 応答を送信して成功を通知します。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-273">Server sends “230” response to signal success.</span></span>
1. <span data-ttu-id="7a5b8-274">クライアントがバイナリ転送用の "TYPE I" メッセージを送信します。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-274">Client sends “TYPE I” message for binary transfer.</span></span>
1. <span data-ttu-id="7a5b8-275">サーバーが "200" 応答を送信して成功を通知します。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-275">Server sends “200” response to signal success.</span></span>
1. <span data-ttu-id="7a5b8-276">**"*IPv4 アプリケーション:"\* クライアントが "PASV" メッセージを送信します。*\*</span><span class="sxs-lookup"><span data-stu-id="7a5b8-276">***IPv4 applications:* Client sends “PASV” message.**</span></span><br /><span data-ttu-id="7a5b8-277">**"_IPv6 アプリケーション:"_ クライアントが "EPSV" メッセージを送信します。**</span><span class="sxs-lookup"><span data-stu-id="7a5b8-277">**_IPv6 applications:_ Client sends “EPSV” message.**</span></span>
1. <span data-ttu-id="7a5b8-278">**"*IPv4 アプリケーション:"\* サーバーが "227" 応答と、クライアントの接続先となる IP アドレスとポートを送信して、成功を通知します。*\*</span><span class="sxs-lookup"><span data-stu-id="7a5b8-278">***IPv4 applications:* Server sends “227” response, and IP address and port for the Client to connect to, to signal success.**</span></span><br /><span data-ttu-id="7a5b8-279">**"_IPv6 アプリケーション:"_ サーバーが "229" 応答と、クライアントの接続先となる IP アドレスとポートを送信して、成功を通知します。**</span><span class="sxs-lookup"><span data-stu-id="7a5b8-279">**_IPv6 applications:_ Server sends “229” response, and IP address and port for the Client to connect to, to signal success.**</span></span>
1. <span data-ttu-id="7a5b8-280">クライアントが、書き込むファイル名を含む "STOR" メッセージを送信します。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-280">Client sends “STOR” message with file name to write.</span></span>
1. <span data-ttu-id="7a5b8-281">**サーバーがデータ サーバー ソケットを作成し、手順 10. の応答で指定したポートを使用して、このソケットでクライアント接続要求をリッスンします。**</span><span class="sxs-lookup"><span data-stu-id="7a5b8-281">**Server creates data server socket and listens for the Client connect request on this socket using the port specified in the response in step 10.**</span></span>
1. <span data-ttu-id="7a5b8-282">**サーバーが制御ソケットで "150" 応答を送信して、ファイルの書き込みが開始されたことを通知します。**</span><span class="sxs-lookup"><span data-stu-id="7a5b8-282">**Server sends “150” response on the control socket to signal file write has started.**</span></span>
1. <span data-ttu-id="7a5b8-283">クライアントが、データ接続を介してファイルの内容を送信します。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-283">Client sends contents of file through the data connection.</span></span> <span data-ttu-id="7a5b8-284">ファイルが完全に転送されるまで、このプロセスが続行されます。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-284">This process continues until file is completely transferred.</span></span>
1. <span data-ttu-id="7a5b8-285">完了すると、クライアントはデータ接続を切断します。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-285">When finished, Client disconnects data connection.</span></span>
1. <span data-ttu-id="7a5b8-286">**サーバーが制御ソケットで "226" 応答を送信して、ファイルの書き込みが成功したことを通知します。**</span><span class="sxs-lookup"><span data-stu-id="7a5b8-286">**Server sends “226” response on the control socket to signal file write is successful.**</span></span>
1. <span data-ttu-id="7a5b8-287">クライアントが "QUIT" を送信して FTP 接続を終了します。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-287">Client sends “QUIT” to terminate FTP connection.</span></span>
1. <span data-ttu-id="7a5b8-288">サーバーが "221" 応答を送信して、切断が成功したことを通知します。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-288">Server sends “221” response to signal disconnect is successful.</span></span>
1. <span data-ttu-id="7a5b8-289">サーバーが FTP 接続を切断します。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-289">Server disconnects FTP connection.</span></span>

## <a name="ftp-authentication"></a><span data-ttu-id="7a5b8-290">FTP Authentication</span><span class="sxs-lookup"><span data-stu-id="7a5b8-290">FTP Authentication</span></span>

<span data-ttu-id="7a5b8-291">FTP 接続が行われるたびに、クライアントは "*ユーザー名*" と "*パスワード*" をサーバーに提供する必要があります。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-291">Whenever an FTP connection takes place, the Client must provide the Server with a *username* and *password*.</span></span> <span data-ttu-id="7a5b8-292">一部の FTP サイトでは、特定のユーザー名とパスワードなしで FTP アクセスを許可する、"*匿名 FTP*" と呼ばれるものを使用できます。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-292">Some FTP sites allow what is called *Anonymous FTP*, which allows FTP access without a specific username and password.</span></span> <span data-ttu-id="7a5b8-293">この種類の接続では、ユーザー名に "anonymous" を指定し、パスワードには完全な電子メール アドレスを使用します。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-293">For this type of connection, “anonymous” should be supplied for username and the password should be a complete e-mail address.</span></span>

<span data-ttu-id="7a5b8-294">ログインおよびログアウト認証ルーチンは、ユーザーが NetX FTP に提供する必要があります。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-294">The user is responsible for supplying NetX FTP with login and logout authentication routines.</span></span> <span data-ttu-id="7a5b8-295">これらは、***nxd_ftp_server_create** _ および _*_nx_ftp_server_create_\*_ サービスの実行中に提供され、パスワード処理から呼び出されます。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-295">These are supplied during the ***nxd_ftp_server_create** _ and _*_nx_ftp_server_create_\*_ services and called from the password processing.</span></span> <span data-ttu-id="7a5b8-296">この 2 つの違いは、ログインおよびログアウト認証関数への _*_nxd_ftp_server_create_*_ の入力関数ポインターでは、NetX Duo の _*_NXD_ADDRESS_*_ アドレス型が想定されていることです。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-296">The difference between the two is the _*_nxd_ftp_server_create_*_ input function pointers to login and logout authenticate functions expect the NetX Duo address type _*_NXD_ADDRESS_*_.</span></span> <span data-ttu-id="7a5b8-297">このデータ型では IPv4 と IPv6 の両方のアドレス形式が保持されるので、この関数は IPv4 と IPv6 の両方のネットワークをサポートする "duo" サービスになります。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-297">This data type holds both IPv4 or IPv6 address formats, making this function the “duo” service supporting both IPv4 and IPv6 networks.</span></span> <span data-ttu-id="7a5b8-298">ログインおよびログアウト認証関数への、_ *_nx_ftp_server_create_*\* の入力関数ポインターでは、ULONG IP アドレス型が想定されています。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-298">The _ *_nx_ftp_server_create_*\* input function pointers to login and logout authenticate functions expect ULONG IP address type.</span></span> <span data-ttu-id="7a5b8-299">この関数は IPv4 ネットワークに限定されます。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-299">This function is limited to IPv4 networks.</span></span> <span data-ttu-id="7a5b8-300">開発者は、可能な限り "duo" サービスを使用することをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-300">The developer is encouraged to use the “duo” service whenever possible.</span></span>

<span data-ttu-id="7a5b8-301">*login* 関数から NX_SUCCESS が返された場合は、接続が認証され、FTP 操作が許可されます。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-301">If the *login* function returns NX_SUCCESS, the connection is authenticated and FTP operations are allowed.</span></span> <span data-ttu-id="7a5b8-302">*login* 関数から NX_SUCCESS 以外のものが返された場合、接続試行は拒否されます。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-302">Otherwise, if the *login* function returns something other than NX_SUCCESS, the connection attempt is rejected.</span></span>

## <a name="ftp-multi-thread-support"></a><span data-ttu-id="7a5b8-303">FTP マルチスレッドのサポート</span><span class="sxs-lookup"><span data-stu-id="7a5b8-303">FTP Multi-Thread Support</span></span>

<span data-ttu-id="7a5b8-304">NetX FTP クライアント サービスは、複数のスレッドから同時に呼び出すことができます。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-304">The NetX FTP Client services can be called from multiple threads simultaneously.</span></span> <span data-ttu-id="7a5b8-305">ただし、特定の FTP クライアント インスタンスの読み取りまたは書き込み要求は、同じスレッドから順番に実行する必要があります。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-305">However, read or write requests for a particular FTP Client instance should be done in sequence from the same thread.</span></span>

## <a name="ftp-rfcs"></a><span data-ttu-id="7a5b8-306">FTP RFC</span><span class="sxs-lookup"><span data-stu-id="7a5b8-306">FTP RFCs</span></span>

<span data-ttu-id="7a5b8-307">NetX Duo FTP は、RFC 959、RFC 2428、および関連する RFC に準拠しています。</span><span class="sxs-lookup"><span data-stu-id="7a5b8-307">NetX Duo FTP is compliant with RFC 959, RFC 2428 and related RFCs.</span></span>
