---
title: '第 1 章: Azure RTOS NetX Secure の概要'
description: この章では、Azure RTOS NetX Secure の概要と、そのアプリケーションおよび利点について説明します。
author: philmea
ms.author: philmea
ms.date: 06/04/2020
ms.topic: article
ms.service: rtos
ms.openlocfilehash: 1d6b0f23d7353626f340fe0ab93ee1e04800edaaa1f00da49afd83f84339df86
ms.sourcegitcommit: 93d716cf7e3d735b18246d659ec9ec7f82c336de
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/07/2021
ms.locfileid: "116791603"
---
# <a name="chapter-1---introduction-to-azure-rtos-netx-secure"></a>第 1 章: Azure RTOS NetX Secure の概要

Azure RTO NetX Secure は、暗号化ネットワーク セキュリティ標準の高パフォーマンスなリアルタイム実装で、ThreadX ベースの組み込みアプリケーション専用に設計された TLS/SSL が含まれます。 この章では、NetX Secure の概要と、そのアプリケーションおよび利点について説明します。

## <a name="netx-secure-unique-features"></a>NetX Secure 固有の機能

NetX Secure は、TLS の他のほとんどの実装とは異なり、さまざまな組み込みハードウェア プラットフォームをサポートするために一から設計されました。そして、小さなマイクロコントローラー アプリケーションから、提供されている最も強力な組み込みプロセッサまで、規模の拡大が容易です。 コードは、組み込みシステムの限られたリソースを考慮に入れて記述されており、セキュリティで保護される、TLS 経由のネットワーク通信を提供するために必要なメモリ占有領域を減少させる構成オプションが多数用意されています。

## <a name="rfcs-supported-by-netx-secure"></a>NetX Secure でサポートされている RFC 

NetX Secure では、TLS に関連する下記のプロトコルがサポートされています。 TLS と暗号化に関連する RFC は多数存在するため、この一覧は必ずしも包括的ではありません。 NetX Secure は、リアルタイム オペレーティング システムの制約の中で、一般的な推奨事項と基本要件をすべて満たしており、メモリ専有領域が少なく、効率的に実行されます。

| RFC      | 説明                                                                                                 | ページ |
|----------|-------------------------------------------------------------------------------------------------------------|------|
| RFC 2104 | HMAC: メッセージ認証用のキー付きハッシング                                                              | 33   |
| RFC 2246 | TLS プロトコル バージョン 1.0                                                                                | 19   |
| RFC 3268 | トランスポート層セキュリティ (TLS) 用の Advanced Encryption Standard (AES) 暗号スイート                          | 31   |
| RFC 3447 | 公開キー暗号化標準 (PKCS) #1: RSA 暗号化仕様バージョン 2.1                    | 32   |
| RFC 4279 | TLS 用の事前共有キー暗号スイート                                                                         | 39   |
| RFC 4346 | トランスポート層セキュリティ (TLS) プロトコル バージョン 1.1                                                     | 19   |
| RFC 5246 | トランスポート層セキュリティ (TLS) プロトコル バージョン 1.2                                                     | 19   |
| RFC 5280 | X.509 PKI 証明書 (v3)                                                                                 | 41   |
| RFC 5746 | トランスポート層セキュリティ (TLS) 再ネゴシエーション指示拡張機能                                           |      |
| RFC 5869 | HMAC ベースの抽出および展開によるキー派生関数 (HKDF)                                                | 19   |
| RFC 6066<sup>1</sup> | トランスポート層セキュリティ (TLS) 拡張機能: 拡張機能の定義                                            | 19   |
| RFC 6234 | 米国セキュア ハッシュ アルゴリズム (SHA および SHA ベースの HMAC および HKDF)                                                 | 33   |
| RFC 8443 | トランスポート層セキュリティ (TLS) バージョン 1.2 以前用の楕円曲線暗号 (ECC) 暗号スイート |      |
| RFC 8446 | トランスポート層セキュリティ (TLS) プロトコル バージョン 1.3                                                     | 19   |

1. バージョン 6.0 以降は、RFC 6066 のうち、Server Name Indication (SNI) 拡張機能のみが完全にサポートされます。

## <a name="netx-secure-requirements"></a>NetX Secure の要件

NetX Secure ランタイム ライブラリを正しく機能させるには、NetX IP インスタンスが既に作成されている必要があります。 さらに、アプリケーションによっては、TLS/DTLS インスタンスの識別やリモート ホストからの証明書の検証のために、DER でエンコードされた X.509 デジタル証明書が 1 つ以上必要になります。 NetX Secure パッケージに、その他の要件はありません。

## <a name="netx-secure-constraints"></a>NetX Secure の制約

NetX Secure プロトコルでは、オプション (既定で無効) の RFC 4346 (TLS 1.1) および RFC 2246 (TLS 1.0) との下位互換性を提供するだけでなく、TLS 1.2 のために RFC 5246 標準の要件を、TLS 1.3 のために RFC 8446 の要件を実装します。 ただし、次の制約があります。

- TLS 1.2 と TLS 1.3 に対しては、256 SHA-1 を使用する暗号スイートのみがサポートされます。 TLS 1.2 より前のバージョンでは、TLS ハンドシェイクにおいて、TLS ハンドシェイク メッセージが改ざんされないことが固定ハッシュ ルーチンを使用して検証されます。 バージョン 1.2 以降では、ハンドシェイクにおいて、暗号スイートと共に提供されるハッシュ ルーチンが使用されます。 TLS では、どのハッシュ ルーチンが使用されるかは事前に認識されず、ハンドシェイク メッセージをキャッシュする必要があります。 ハッシュを SHA-256 に修正することで、NetX Secure TLS は他の TLS 実装よりも小さな RAM 専有領域で機能できます。 メモリ使用量について適切な対処が行われれば、今後のバージョンでこの制限は解消される予定です。 *重要な注意: この制限は、暗号スイートの選択に **のみ** 適用されます。 X.509 証明書の署名は、この制限の影響を受けず、サポートされている任意のハッシュ ルーチンを使用することができます。
- 組み込みデバイスの性質上、アプリケーションによっては、TLS レコードの最大サイズである 16 KB をサポートするためのリソースがない場合があります。 十分なリソースを持つデバイスでは、NetX Secure によって 16 KB のレコードを処理できます。 TLS の再構築バッファー (*nx_secure_tls_session_packet_buffer_set* の API リファレンスを参照) が、相互運用性を犠牲にして、16 KB 未満のサイズに設定されている **場合があります**。 再構築バッファーより大きい有効な TLS レコードを受信した場合、NetX Secure TLS では、エラーを発して TLS セッションが中止されます。 一般に、このバッファーは常に、少なくとも 18 KB (16 KB の TLS レコード サイズと暗号化パディング用の 2 KB) に設定されている必要があり、より小さくするのは、制御下の設定 (例: リモート ホストで最大の TLS レコード サイズが保証されている) でのみにする必要があります。
  > [!NOTE]
  > 一般に、パケット再構築バッファーは、TLS の最大レコード サイズよりも小さくしてはいけません。 ただし、リモート ホストの特性が既知である場合 (完全に閉じられたシステム内など) は、サイズを小さくして一部の RAM 領域を回復することができます。
- 最低限の証明書の検証。 NetX Secure では、証明書に対して基本的な X.509 チェーン検証が実行され、証明書が有効であり、信頼された証明機関によって署名されていることが確認されます。また、アプリケーションでリモート ホストのトップレベル ドメイン名と比較するために、証明書の共通名を提供することができます。 リアルタイム クロックが使用可能な場合は、証明書の有効期限を確認するために使用できます (API の nx_secure_tls_session_time_function_set を参照)。 ただし、証明書拡張機能やその他のデータの検証は、アプリケーションの実装者が行う必要があります。
- ソフトウェアベースの暗号化では、プロセッサが集中的に消費されます。 NetX Secure のソフトウェアベースの暗号化ルーチンは、パフォーマンスのために最適化されてきましたが、ターゲット プロセッサの性能によっては、そのパフォーマンスにより処理が非常に長くなることがあります。 ハードウェアベースの暗号化を使用できる場合は、NetX Secure DTLS の最適なパフォーマンスのため、それを使用する必要があります。
- TLS ハンドシェイク レコードの断片化はサポートされていません。 特定の TLS ハンドシェイク レコード メッセージが大きすぎる場合、複数の TLS レコードに分割されることがあります。NetX Secure TLS では、現在、これはエラーとして扱われます。 組み込みシステムのメモリ要件は、大きなハンドシェイク レコード メッセージはおそらく処理できないことを意味しますが、過度に大きい証明書チェーンを使用している特定の TLS ホストとの通信時には、この制限からエラーに至る可能性があります。
- ローカル ストアに複数の証明書がある場合、TLS サーバーでは、動的な証明書の選択はサポートされません。 
- X509 証明書の KeyUsage は確認されません。 
- ECDH ベースの暗号スイートはサポートされていません。 代わりに ECDHE を使用してください。
