---
title: 第 1 章 - Azure RTOS NetX Duo DHCPv6 クライアントの概要
description: IPv6 ネットワークでは、DHCPv6 サーバーからの動的なグローバル IP アドレスの割り当てに、DHCP ではなく DHCPv6 が使用され、ほとんどの同じ機能と、多くの拡張機能が提供されています。
author: philmea
ms.author: philmea
ms.date: 06/04/2020
ms.topic: article
ms.service: rtos
ms.openlocfilehash: 3bf3b52c53bb26e2c9c2c736ae35817eb967f609
ms.sourcegitcommit: e3d42e1f2920ec9cb002634b542bc20754f9544e
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 03/22/2021
ms.locfileid: "104810913"
---
# <a name="chapter-1---introduction-to-azure-rtos-netx-duo-dhcpv6-client"></a><span data-ttu-id="495d5-103">第 1 章 - Azure RTOS NetX Duo DHCPv6 クライアントの概要</span><span class="sxs-lookup"><span data-stu-id="495d5-103">Chapter 1 - Introduction to Azure RTOS NetX Duo DHCPv6 Client</span></span>

<span data-ttu-id="495d5-104">IPv6 ネットワークでは、DHCPv6 サーバーからの動的なグローバル IP アドレスの割り当てに、DHCP ではなく DHCPv6 が使用され、ほとんどの同じ機能と、多くの拡張機能が提供されています。</span><span class="sxs-lookup"><span data-stu-id="495d5-104">In IPv6 networks, DHCPv6 replaces DHCP for dynamic global IP address assignment from a DHCPv6 Server, and offers most of the same features as well as many enhancements.</span></span> <span data-ttu-id="495d5-105">このドキュメントでは、Azure RTOS NetX Duo DHCPv6 クライアント API を使用して IPv6 アドレスを取得する方法について詳しく説明します。</span><span class="sxs-lookup"><span data-stu-id="495d5-105">This document will explain in detail how the Azure RTOS NetX Duo DHCPv6 Client API is used to obtain IPv6 addresses.</span></span>

## <a name="dhcpv6-communication"></a><span data-ttu-id="495d5-106">DHCPv6 の通信</span><span class="sxs-lookup"><span data-stu-id="495d5-106">DHCPv6 Communication</span></span>

<span data-ttu-id="495d5-107">DHCPv6 プロトコルでは UDP が使用されます。</span><span class="sxs-lookup"><span data-stu-id="495d5-107">The DHCPv6 protocol uses UDP.</span></span> <span data-ttu-id="495d5-108">DHCPv6 メッセージの交換のため、クライアントではポート 546 が使用され、サーバーではポート 547 が使用されます。</span><span class="sxs-lookup"><span data-stu-id="495d5-108">The Client uses port 546 and the Server uses port 547 to exchange DHCPv6 messages.</span></span> <span data-ttu-id="495d5-109">クライアントで使用可能な DHCPv6 サーバーへの DHCPv6 要求を開始するには、送信元アドレスとしてリンク ローカル アドレスが使用されます。</span><span class="sxs-lookup"><span data-stu-id="495d5-109">The Client uses its link local address for a source address to initiate the DHCPv6 requests to the DHCPv6 server(s) available.</span></span> <span data-ttu-id="495d5-110">クライアントにより、ネットワーク上のすべての DHCPv6 サーバーを対象としたメッセージが送信されるときは、*All_DHCP_Relay_Agents_and_Servers* のマルチキャスト アドレス *FF02::01:02* が使用されます。</span><span class="sxs-lookup"><span data-stu-id="495d5-110">When the Client sends messages intended for all DHCPv6 servers on the network it uses the *All_DHCP_Relay_Agents_and_Servers* multicast address *FF02::01:02*.</span></span> <span data-ttu-id="495d5-111">これは、予約されているリンク スコープのマルチキャスト アドレスです。</span><span class="sxs-lookup"><span data-stu-id="495d5-111">This is a reserved, link-scoped multicast address.</span></span>

## <a name="dhcpv6-process-of-requesting-an-ipv6-address"></a><span data-ttu-id="495d5-112">IPv6 アドレスを要求する DHCPv6 のプロセス</span><span class="sxs-lookup"><span data-stu-id="495d5-112">DHCPv6 Process of Requesting an IPv6 Address</span></span>

<span data-ttu-id="495d5-113">クライアントにより、グローバル IPv6 アドレスの割り当てを要求するプロセスが開始されるときは、最初に *nx_dhcpv6_send_solicit* サービスを使用して SOLICIT メッセージが送信されます。</span><span class="sxs-lookup"><span data-stu-id="495d5-113">To begin the process of requesting a global IPv6 address assignment, a Client first sends a SOLICIT message using the *nx_dhcpv6_send_solicit* service:</span></span>

<span data-ttu-id="495d5-114">**UINT nx_dhcpv6_request_solicit(NX_DHCPV6 \*dhcpv6_ptr)**</span><span class="sxs-lookup"><span data-stu-id="495d5-114">**UINT nx_dhcpv6_request_solicit(NX_DHCPV6 \*dhcpv6_ptr)**</span></span>

<span data-ttu-id="495d5-115">このメッセージは、*All_DHCP_Relay_Agents_and_Servers* のアドレスを使用してすべてのサーバーに送信されます。</span><span class="sxs-lookup"><span data-stu-id="495d5-115">This message is sent to all servers using the *All_DHCP_Relay_Agents_and_Servers* address.</span></span> <span data-ttu-id="495d5-116">SOLICIT 要求において、クライアントは、サーバーへのヒントとして、特定の IPv6 アドレスの割り当てを要求できます。</span><span class="sxs-lookup"><span data-stu-id="495d5-116">In the SOLICIT request, the Client may request the assignment of specific IPv6 address(es) as a hint to the Server.</span></span> <span data-ttu-id="495d5-117">また、SOLICIT メッセージのオプション要求では、DNS サーバー、NTP サーバー、その他のオプションなど、他のネットワーク構成情報をサーバーに要求することもできます。</span><span class="sxs-lookup"><span data-stu-id="495d5-117">It can also request other network configuration information from the Server such as DNS server, NTP server and other options in the Option Request in the SOLICIT message.</span></span>

<span data-ttu-id="495d5-118">クライアントの要求に対応できる DHCPv6 サーバーは、クライアントに割り当てることができる IPv6 アドレス、IPv6 アドレスのリース時間、およびクライアントによって要求された追加情報が含まれる ADVERTISE メッセージで応答します。</span><span class="sxs-lookup"><span data-stu-id="495d5-118">A DHCPv6 Server that can service a Client request responds with an ADVERTISE message containing the IPv6 address(es) it can assign to the Client, the IPv6 address lease time and any additional information requested by the Client.</span></span> <span data-ttu-id="495d5-119">DHCPv6 クライアント プロトコルの場合、クライアントは、ネットワーク上のすべての DHCPv6 サーバーから ADVERTISE メッセージを受信するまで、待機する必要があります。</span><span class="sxs-lookup"><span data-stu-id="495d5-119">The DHCPv6 Client protocol requires the Client to wait for a period of time to receive ADVERTISE messages from all DHCPv6 Servers on the network.</span></span> <span data-ttu-id="495d5-120">各 ADVERTISE メッセージが有効なメッセージとして前処理され、さまざまな DHCPv6 パラメーターのオプション データがスキャンされます。</span><span class="sxs-lookup"><span data-stu-id="495d5-120">It pre-processes each ADVERTISE message to be a valid message, and scans the option data for various DHCPv6 parameters.</span></span> <span data-ttu-id="495d5-121">また、サーバーによって指定されている場合は、優先設定オプションの設定値も確認されます。</span><span class="sxs-lookup"><span data-stu-id="495d5-121">It also checks the Preference value in the Preference Option, if supplied by the Server.</span></span> <span data-ttu-id="495d5-122">複数の ADVERTISE メッセージを受信した場合は、NetX DHCPv6 クライアントによって、待機期間の終了までに受信したサーバーの中で優先順位の値が最も高いものが選択されます。</span><span class="sxs-lookup"><span data-stu-id="495d5-122">If more than one ADVERTISE message is received, the NetX DHCPv6 Client chooses the Server with the highest preference value received by the end of the wait period.</span></span>

<span data-ttu-id="495d5-123">ただし、優先順位の値が 255 の ADVERTISE メッセージをクライアントが受信した場合は例外です。</span><span class="sxs-lookup"><span data-stu-id="495d5-123">The exception is if the Client receives an ADVERTISE message with a preference value of 255.</span></span> <span data-ttu-id="495d5-124">そのメッセージはすぐに受け入れられて、それ以降のすべての ADVERTISE メッセージは破棄されます。</span><span class="sxs-lookup"><span data-stu-id="495d5-124">It accepts that message immediately and discards all subsequent ADVERTISE messages.</span></span>

<span data-ttu-id="495d5-125">待機時間は、DHCPv6 クライアントがどのサーバーからも応答を受信しない場合に、別の SOLICIT メッセージを送信する前に待機する再送信期間として定義されます。</span><span class="sxs-lookup"><span data-stu-id="495d5-125">The wait period is defined as the retransmission period that the DHCPv6 Client waits before sending another SOLICIT message if it has not received a response from any Server.</span></span> <span data-ttu-id="495d5-126">SOLICIT 状態の最初の再送信タイムアウトは、DHCPv6 プロトコルに関する RFC 3315 の説明で 1 秒に定義されています。</span><span class="sxs-lookup"><span data-stu-id="495d5-126">The initial retransmission timeout in the SOLICIT state is defined by to the DHCPv6 protocol described in RFC 3315 to be 1 second.</span></span> <span data-ttu-id="495d5-127">DHCPv6 クライアントで有効なサーバー応答が受信されない場合、その後の再送信間隔は、最大 120 秒になるまで倍々に増えていきます。</span><span class="sxs-lookup"><span data-stu-id="495d5-127">Subsequent retransmission intervals, if the DHCPv6 Client fails to receive a valid Server response, are doubled up to a maximum of 120 seconds.</span></span>

<span data-ttu-id="495d5-128">サーバーが選択されると、クライアントにより、ADVERTISE メッセージからデータが抽出され、割り当てられたアドレス情報とリース時間を受け取るために、REQUEST メッセージがサーバーに送り返されます。</span><span class="sxs-lookup"><span data-stu-id="495d5-128">Having chosen the Server, the Client extracts data from the ADVERTISE message and sends a REQUEST message back to the Server to accept the assigned address information and lease times.</span></span> <span data-ttu-id="495d5-129">サーバーからは、クライアントの IPv6 アドレスがクライアントに割り当て済みとしてサーバーに登録されたことを確認する REPLY メッセージが応答されます。</span><span class="sxs-lookup"><span data-stu-id="495d5-129">The Server responds with a REPLY message to confirm the Client IPv6 address(es) are registered with the Server as assigned to the Client.</span></span>

<span data-ttu-id="495d5-130">DHCPv6 クライアントにより、割り当てられた IPv6 アドレスが IP インスタンス (NetX Duo など) に登録されます。</span><span class="sxs-lookup"><span data-stu-id="495d5-130">The DHCPv6 Client registers the assigned IPv6 address(es) with the IP instance (e.g NetX Duo).</span></span> <span data-ttu-id="495d5-131">重複アドレス検出 (DAD) プロトコル用に構成されている場合 (既定で有効)、NetX Duo により Neighbor Solicit メッセージが自動的に送信され、割り当てられたアドレスがネットワーク上で一意であることが確認されます。</span><span class="sxs-lookup"><span data-stu-id="495d5-131">If configured for the Duplicate Address Detection (DAD) protocol (enabled by default), NetX Duo will automatically send Neighbor Solicit messages to verify the assigned address(es) are unique on the network.</span></span> <span data-ttu-id="495d5-132">その場合、割り当てられた各アドレスが TENTATIVE から VALID に昇格されると、DHCPv6 クライアントに通知されます。</span><span class="sxs-lookup"><span data-stu-id="495d5-132">If so, it notifies the DHCPv6 Client when the each assigned address has been promoted from TENTATIVE to VALID.</span></span> <span data-ttu-id="495d5-133">DHCPv6 クライアントは BOUND 状態に昇格され、デバイスはその IPv6 アドレスを使用してメッセージの送受信を行うことができます。</span><span class="sxs-lookup"><span data-stu-id="495d5-133">The DHCPv6 Client is promoted to the BOUND state and the device may use that IPv6 address to send and transmit messages.</span></span> <span data-ttu-id="495d5-134">DAD プロトコルが失敗した場合は、NetX Duo から DHCPv6 クライアントに通知され、DHCPv6 クライアントにより、IPv6 アドレスの割り当てをサーバーに戻す DECLINE メッセージが送信されて、DHCPv6 クライアントの状態は INIT 状態にリセットされます。</span><span class="sxs-lookup"><span data-stu-id="495d5-134">If the DAD protocol fails, NetX Duo notifies the DHCPv6 Client and the DHCPv6 Client sends a DECLINE message for the IPv6 address(es) assigned back to the Server and resets the DHCPv6 Client state to the INIT state.</span></span>

### <a name="notification-of-successful-address-assignment-and-validation"></a><span data-ttu-id="495d5-135">アドレスの割り当てと検証の成功通知</span><span class="sxs-lookup"><span data-stu-id="495d5-135">Notification of Successful Address Assignment and Validation</span></span>

<span data-ttu-id="495d5-136">DHCPv6 クライアントに *nx_dhcpv6_client_create* サービスで状態変更コールバックが構成されている場合は、アプリケーションで、状態の変化から DHCPv6 クライアントによるアドレス要求の結果を判断できます。</span><span class="sxs-lookup"><span data-stu-id="495d5-136">The application can determine the result of the DHCPv6 Client address solicitation from the state changes if the DHCPv6 Client is configured with the state change callback in the *nx_dhcpv6_client_create* service.</span></span> <span data-ttu-id="495d5-137">サーバーから応答が返されない場合、観察された状態変化は SOLICIT から INIT です。</span><span class="sxs-lookup"><span data-stu-id="495d5-137">If it receives no response from the Server the state change observed is from SOLICIT to INIT.</span></span> <span data-ttu-id="495d5-138">サーバーから応答を受信したが、サーバーでアドレスを割り当てられない場合は、DHCPv6 クライアントのサーバー エラー コールバックによって (*nx_dhcpv6_client_create* で構成されている場合)、アプリケーションに通知されます。</span><span class="sxs-lookup"><span data-stu-id="495d5-138">If it received a response from the Server but the Server is unable to assign the address, the application will be notified by the DHCPv6 Client server error callback if configured with one (also in *nx_dhcpv6_client_create).*</span></span> <span data-ttu-id="495d5-139">クライアントが BOUND 状態に達しても、DAD チェックで失敗した場合は、状態が BOUND から INIT に変更されます。</span><span class="sxs-lookup"><span data-stu-id="495d5-139">If the Client achieved the BOUND state but then failed the DAD check, it will see a state change from BOUND to INIT.</span></span> <span data-ttu-id="495d5-140">DAD が有効になっているアプリケーションでは、要求プロセス開始後に、DAD チェックの時間的余裕を設ける必要があることに注意してください。</span><span class="sxs-lookup"><span data-stu-id="495d5-140">Note that an application that is enabled for DAD must allow time for the DAD check after starting the request process.</span></span> <span data-ttu-id="495d5-141">通常、これは約 400 から 500 ティックです (ほとんどの場合、4 から 5 秒)。</span><span class="sxs-lookup"><span data-stu-id="495d5-141">Typically this is about 400-500 ticks (4-5 seconds in most cases).</span></span>

### <a name="relinquishing-an-ipv6-address"></a><span data-ttu-id="495d5-142">IPv6 アドレスの破棄</span><span class="sxs-lookup"><span data-stu-id="495d5-142">Relinquishing an IPv6 Address</span></span>

<span data-ttu-id="495d5-143">割り当てられた IPv6 アドレスをクライアントで解放する必要がある場合は、*nx_dhcpv6_request_release* サービスを呼び出して DHCPv6 サーバーに通知します。</span><span class="sxs-lookup"><span data-stu-id="495d5-143">If and when the Client needs to release an assigned IPv6 address, it informs the DHCPv6 server by calling the *nx_dhcpv6_request_release* service:</span></span>

### <a name="uint-nx_dhcpv6_request_releasenx_dhcpv6-dhcpv6_ptr"></a><span data-ttu-id="495d5-144">UINT nx_dhcpv6_request_release(NX_DHCPV6 \*dhcpv6_ptr)</span><span class="sxs-lookup"><span data-stu-id="495d5-144">UINT nx_dhcpv6_request_release(NX_DHCPV6 \*dhcpv6_ptr)</span></span>

<span data-ttu-id="495d5-145">DHCPv6 クライアントにより、割り当てられたアドレスが含まれるユニキャスト RELEASE メッセージが、アドレスを割り当てたサーバーに送信され、メッセージの受信を確認するサーバーからの REPLY が待機されます。</span><span class="sxs-lookup"><span data-stu-id="495d5-145">The DHCPv6 Client sends a unicast RELEASE message containing the assigned addresses to the Server who assigned the address and waits for a REPLY confirming the Server received the message.</span></span>

<span data-ttu-id="495d5-146">注: 割り当てられた IPv6 アドレスを、電源を切ってから再起動時したときも引き続き使用することを計画しているクライアントには、異なるプロセスがあります。</span><span class="sxs-lookup"><span data-stu-id="495d5-146">Note: There is a different process for the Client that is powering down but plans to continue using the assigned IPv6 addresses on reboot.</span></span> <span data-ttu-id="495d5-147">電源を入れるときに新しいアドレスを要求しない場合、電源を切るときに RELEASE メッセージを送信しません。</span><span class="sxs-lookup"><span data-stu-id="495d5-147">It does not send the RELEASE message on powering down unless it plans to request a new address on power up.</span></span> <span data-ttu-id="495d5-148">この状況の説明については、「不揮発性メモリの要件」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="495d5-148">See “Non Volatile Memory Requirements” for explanation of this situation.</span></span>

### <a name="dhcpv6-lease-timeouts"></a><span data-ttu-id="495d5-149">DHCPv6 リースのタイムアウト</span><span class="sxs-lookup"><span data-stu-id="495d5-149">DHCPv6 Lease Timeouts</span></span>

<span data-ttu-id="495d5-150">サーバーによって割り当てられた IPv6 リースには、ID 関連付け – 非一時的アドレス (IANA) ブロックごとに、2 つのタイムアウト パラメーター T1 と T2 が含まれています。</span><span class="sxs-lookup"><span data-stu-id="495d5-150">The IPv6 lease assigned by the Server contains two timeout parameters, T1 and T2 in each Identity Association – Non Temporary Addresses (IANA) block.</span></span> <span data-ttu-id="495d5-151">IANA については、このユーザー ガイドの他の場所で説明されています。</span><span class="sxs-lookup"><span data-stu-id="495d5-151">An IANA is described in elsewhere in this User Guide.</span></span> <span data-ttu-id="495d5-152">割り当てられた IPv6 アドレスに DHCPv6 クライアントがバインドされてからの経過時間が T1 の場合、DHCPv6 クライアントにより、RENEW メッセージを送信することによって、IPv6 アドレスの更新が自動的に開始されます。</span><span class="sxs-lookup"><span data-stu-id="495d5-152">If the elapsed time from when the DHCPv6 Client was bound to the assigned IPv6 address equals T1, the DHCPv6 Client automatically starts renewing the IPv6 address by sending a RENEW message.</span></span> <span data-ttu-id="495d5-153">経過時間が T2 の場合、RENEW 要求への応答を受信していない場合は、DHCPv6 クライアントによって REBIND メッセージが自動的に送信されます。</span><span class="sxs-lookup"><span data-stu-id="495d5-153">If the elapsed time equals T2, DHCPv6 Client automatically sends a REBIND message if it received no responses to its RENEW requests.</span></span>

<span data-ttu-id="495d5-154">他に 2 つの IPv6 リース パラメーター (優先および有効な有効期間) が、IANA ブロックに含まれる各 ID 関連付け (IA) ブロックに割り当てられます。</span><span class="sxs-lookup"><span data-stu-id="495d5-154">Two other IPv6 lease parameters, preferred and valid lifetime, are assigned with each Identity Association (IA) block contained in the IANA block.</span></span> <span data-ttu-id="495d5-155">優先および有効な有効期間は、それぞれ、割り当てられた IPv6 アドレスが非推奨または無効になるまでの期間です。</span><span class="sxs-lookup"><span data-stu-id="495d5-155">The preferred and valid lifetimes are when the assigned IPv6 address is deprecated or invalid, respectively.</span></span> <span data-ttu-id="495d5-156">T1 は、優先される有効期間より短くする必要があります。</span><span class="sxs-lookup"><span data-stu-id="495d5-156">T1 must be less than the preferred lifetime.</span></span> <span data-ttu-id="495d5-157">T2 は、有効な有効期間より短くする必要があります。</span><span class="sxs-lookup"><span data-stu-id="495d5-157">T2 must be less than the valid lifetime.</span></span>

### <a name="ip-thread-task-requirements"></a><span data-ttu-id="495d5-158">IP スレッド タスクの要件</span><span class="sxs-lookup"><span data-stu-id="495d5-158">IP Thread Task Requirements</span></span>

<span data-ttu-id="495d5-159">NetX Duo DHCPv6 クライアントでは、DHCPv6 クライアント サービスを使用する DHCPv6 クライアントを作成する前に、NetX Duo IP インスタンスを作成する必要があります。</span><span class="sxs-lookup"><span data-stu-id="495d5-159">The NetX Duo DHCPv6 Client requires creation of a NetX Duo IP instance previous to creating the DHCPv6 Client to use DHCPv6 Client services.</span></span>

<span data-ttu-id="495d5-160">DHCPv6 クライアントを使用する前に、IP インスタンスで UDP、IPv6、ICMPv6 を有効にする必要があります。</span><span class="sxs-lookup"><span data-stu-id="495d5-160">UDP, IPv6, and ICMPv6 must be enabled on the IP instance prior to the using DHCPv6 Client.</span></span>

  - <span data-ttu-id="495d5-161">*nx_udp_enable*</span><span class="sxs-lookup"><span data-stu-id="495d5-161">*nx_udp_enable*</span></span>

  - <span data-ttu-id="495d5-162">*nxd_ipv6_enable*</span><span class="sxs-lookup"><span data-stu-id="495d5-162">*nxd_ipv6_enable*</span></span>

  - <span data-ttu-id="495d5-163">*nxd_icmp_enable*</span><span class="sxs-lookup"><span data-stu-id="495d5-163">*nxd_icmp_enable*</span></span>

### <a name="packet-pool-requirements"></a><span data-ttu-id="495d5-164">パケット プールの要件</span><span class="sxs-lookup"><span data-stu-id="495d5-164">Packet Pool Requirements</span></span>

<span data-ttu-id="495d5-165">NetX Duo DHCPv6 クライアントを作成するには、DHCPv6 メッセージを送信するために以前に作成したパケット プールが必要です。</span><span class="sxs-lookup"><span data-stu-id="495d5-165">NetX Duo DHCPv6 Client creation requires a previously created packet pool for sending DHCPv6 messages.</span></span> <span data-ttu-id="495d5-166">パケット プールのサイズは、パケット ペイロードと使用可能なパケットの数に関してユーザーが構成可能であり、DHCPv6 メッセージとアプリケーションによる他の送信の予想される量によって異なります。</span><span class="sxs-lookup"><span data-stu-id="495d5-166">The size of the packet pool in terms of packet payload and number of packets available is user configurable, and depends on the anticipated volume of DHCPv6 messages and other transmissions the application will be sending.</span></span>

<span data-ttu-id="495d5-167">一般的な DHCPv6 メッセージは約 200 バイトであり、クライアントで必要な IA アドレスと DHCPv6 オプションの数に依存します。</span><span class="sxs-lookup"><span data-stu-id="495d5-167">A typical DHCPv6 message is about 200 bytes depending on the number of IA addresses and DHCPv6 options requested by the Client.</span></span>

### <a name="network-requirements"></a><span data-ttu-id="495d5-168">ネットワークの要件</span><span class="sxs-lookup"><span data-stu-id="495d5-168">Network Requirements</span></span>

<span data-ttu-id="495d5-169">NetX Duo DHCPv6 クライアントでは、ポート 546 にバインドされた UDP ソケットを作成する必要があります。</span><span class="sxs-lookup"><span data-stu-id="495d5-169">The NetX Duo DHCPv6 Client requires the creation of UDP socket bound to port 546.</span></span> <span data-ttu-id="495d5-170">ソケットは、DHCPv6 クライアント タスクが作成されるときに作成されます。</span><span class="sxs-lookup"><span data-stu-id="495d5-170">The socket is created when the DHCPv6 Client task is created.</span></span>

### <a name="non-volatile-memory-requirements"></a><span data-ttu-id="495d5-171">不揮発性メモリの要件</span><span class="sxs-lookup"><span data-stu-id="495d5-171">Non Volatile Memory Requirements</span></span>

<span data-ttu-id="495d5-172">DHCPv6 クライアントで、電源切断時に DHCPv6 サーバーとの IPv6 リースを解放し、再起動時に新しい IPv6 アドレスを要求する場合、不揮発性メモリ記憶域は必要ありません。</span><span class="sxs-lookup"><span data-stu-id="495d5-172">If a DHCPv6 Client releases its IPv6 lease with the DHCPv6 Server when powering down, and requests new IPv6 address(es) on reboot, then non volatile memory storage is not required.</span></span> <span data-ttu-id="495d5-173">クライアントで割り当てられたリースを引き続き使用したい場合は、DHCPv6 クライアントに関する特定の情報を、再起動の間、不揮発性メモリに格納する必要があります。</span><span class="sxs-lookup"><span data-stu-id="495d5-173">If a Client wishes to continue using its assigned lease, it must store certain information about the DHCPv6 Client to non volatile memory across reboots.</span></span>

<span data-ttu-id="495d5-174">不揮発性メモリの要件と DHCPv6 クライアント API については、第 2 章の「**NetX Duo DHCPv6 クライアントの使用**」で詳しく説明されています。</span><span class="sxs-lookup"><span data-stu-id="495d5-174">Non volatile memory requirements and the DHCPv6 Client API are discussed further in **Using the NetX Duo DHCPv6 Client** in Chapter Two.</span></span>

### <a name="netx-duo-dhcpv6-client-limitations"></a><span data-ttu-id="495d5-175">NetX Duo DHCPv6 クライアントの制限事項</span><span class="sxs-lookup"><span data-stu-id="495d5-175">NetX Duo DHCPv6 Client Limitations</span></span>

<span data-ttu-id="495d5-176">NetX Duo DHCPv6 クライアントの現在のリリースには、次の制限があります。</span><span class="sxs-lookup"><span data-stu-id="495d5-176">The current release of the NetX Duo DHCPv6 Client has the following limitations:</span></span>

  - <span data-ttu-id="495d5-177">NetX Duo DHCPv6 クライアントでは、DHCPv6 サーバーにユニキャスト DHCPv6 メッセージを送信するためのサーバー ユニキャスト オプションが、サーバーで許可されている場合でも、サポートされていません。</span><span class="sxs-lookup"><span data-stu-id="495d5-177">NetX Duo DHCPv6 Client does not support the Server Unicast option for sending unicast DHCPv6 messages to the DHCPv6 Server even if the Server indicates this is permitted.</span></span>

  - <span data-ttu-id="495d5-178">NetX Duo DHCPv6 クライアントでは、サーバーによりネットワーク上のクライアントへの IPv6 アドレスの変更が開始される再構成要求は、サポートされていません。</span><span class="sxs-lookup"><span data-stu-id="495d5-178">NetX Duo DHCPv6 Client does not support the Reconfigure request in which a Server initiates IPv6 address changes to the Clients on the network.</span></span>

  - <span data-ttu-id="495d5-179">NetX Duo DHCPv6 クライアントでは、DHCPv6 の一意識別子制御ブロックに対するエンタープライズ形式は、サポートされていません。</span><span class="sxs-lookup"><span data-stu-id="495d5-179">NetX Duo DHCPv6 Client does not support the Enterprise format for the DHCPv6 Unique Identifier control block.</span></span> <span data-ttu-id="495d5-180">リンク レイヤーおよびリンクレイヤーと時間の形式のみがサポートされます。</span><span class="sxs-lookup"><span data-stu-id="495d5-180">It only supports Link Layer and Link Layer Plus Time format.</span></span>

  - <span data-ttu-id="495d5-181">NetX Duo DHCPv6 クライアントでは、一時的関連付け (TA) アドレス要求はサポートされていませんが、非一時的 (IANA) オプション要求はサポートされています。</span><span class="sxs-lookup"><span data-stu-id="495d5-181">NetX Duo DHCPv6 Client does not support Temporary Association (TA) address requests, but does support Non Temporary (IANA) option requests.</span></span>

## <a name="multihome-and-multiple-address-support"></a><span data-ttu-id="495d5-182">マルチホームと複数アドレスのサポート</span><span class="sxs-lookup"><span data-stu-id="495d5-182">Multihome and Multiple Address Support</span></span>

<span data-ttu-id="495d5-183">DHCPv6 クライアントでは、インターフェイスごとに複数のインターフェイスと複数のアドレスがサポートされています。</span><span class="sxs-lookup"><span data-stu-id="495d5-183">The DHCPv6 Client supports multiple interfaces and multiple addresses per interface.</span></span> <span data-ttu-id="495d5-184">DHCPv6 クライアント サービスの *nx_dhcpv6_client_set_interface* を使用することにより、クライアント アプリケーションで、アプリケーションが DHCPv6 サーバーと通信するネットワーク インターフェイスを設定できます。</span><span class="sxs-lookup"><span data-stu-id="495d5-184">The DHCPv6 Client service, *nx_dhcpv6_client_set_interface* enables the Client application to set the network interface on which the application will be communicating with the DHCPv6 Server.</span></span> <span data-ttu-id="495d5-185">DHCPv6 クライアントは既定でプライマリ インターフェイス (インデックス 0) に設定されます。</span><span class="sxs-lookup"><span data-stu-id="495d5-185">The DHCPv6 Client defaults to the primary interface (index zero).</span></span>

<span data-ttu-id="495d5-186">インターフェイスごとに複数のアドレスを使用する場合、DHCPv6 クライアントによって、インデックス 0 から始まるアドレスの内部リストが保持されます。</span><span class="sxs-lookup"><span data-stu-id="495d5-186">For multiple addresses per interface, the DHCPv6 Client keeps an internal list of addresses starting at index 0.</span></span> <span data-ttu-id="495d5-187">DHCPv6 クライアントに登録されている同じアドレスでも、インターフェイス アドレスの IP テーブル内の同じインデックスに必ずしも存在しない場合があることに注意してください。</span><span class="sxs-lookup"><span data-stu-id="495d5-187">Note that the same address registered with the DHCPv6 Client may not necessarily be located at the same index in the IP table of interface addresses.</span></span>

<span data-ttu-id="495d5-188">DHCPv6 クライアント サービスでクライアント IPv6 アドレス リースに関する情報を取得する場合、アドレス インデックスの指定が必要になる場合があります。</span><span class="sxs-lookup"><span data-stu-id="495d5-188">For DHCPv6 Client services that retrieve information about the Client IPv6 address lease, some require an address index to be specified.</span></span> <span data-ttu-id="495d5-189">優先と有効の有効期間を取得する例を次に示します。</span><span class="sxs-lookup"><span data-stu-id="495d5-189">An example for obtaining the preferred and valid lifetimes is shown below:</span></span>

```C
UINT nx_dhcpv6_get_valid_ip_address_lease_time(NX_DHCPV6 *dhcpv6_ptr, 
                                              UINT address_index, 
                                              NXD_ADDRESS *ip_address,
                                              ULONG preferred_lifetime, 
                                              ULONG *valid_lifetime)
```

<span data-ttu-id="495d5-190">*nx_dhcpv6_get_valid_ip_address_count* サービスから割り当てられた有効な IPv6 アドレスの数を、クライアント アプリケーションで取得することもできます。</span><span class="sxs-lookup"><span data-stu-id="495d5-190">The Client application can also retrieve the number of valid IPv6 addresses assigned from the *nx_dhcpv6_get_valid_ip_address_count* service:</span></span>

```C
UINT nx_dhcpv6_get_valid_ip_address_count(NX_DHCPV6 *dhcpv6_ptr, 
                                          UINT *address_count)
```

<span data-ttu-id="495d5-191">NetX Duo で複数のアドレスがサポートされるようになる前に作成された従来の DHCPv6 クライアント サービスは、アドレス インデックスを受け取りません。</span><span class="sxs-lookup"><span data-stu-id="495d5-191">Legacy DHCPv6 Client services which were created before multiple addresses were supported in NetX Duo do not take an address index.</span></span> <span data-ttu-id="495d5-192">そのため、このようなサービスの場合は、クライアントに割り当てられている IA アドレスの数に関係なく、要求されたデータはプライマリ グローバル IA アドレスから取得されます。</span><span class="sxs-lookup"><span data-stu-id="495d5-192">Therefore, with these services, the data requested is taken from the primary global IA address, regardless how many IA addresses are assigned to the Client.</span></span> <span data-ttu-id="495d5-193">例を次に示します。</span><span class="sxs-lookup"><span data-stu-id="495d5-193">An example is shown below:</span></span>

```C
UINT nx_dhcpv6_get_IP_address(NX_DHCPV6 *dhcpv6_ptr, 
                              NXD_ADDRESS *ip_address)
```

## <a name="netx-duo-dhcpv6-client-callback-functions"></a><span data-ttu-id="495d5-194">NetX Duo DHCPv6 クライアントのコールバック関数</span><span class="sxs-lookup"><span data-stu-id="495d5-194">NetX Duo DHCPv6 Client Callback Functions</span></span>

<span data-ttu-id="495d5-195">*nx_dhcpv6_state_change_callback*</span><span class="sxs-lookup"><span data-stu-id="495d5-195">*nx_dhcpv6_state_change_callback*</span></span>

<span data-ttu-id="495d5-196">DHCPv6 要求の処理の結果として、DHCPv6 クライアントが新しい DHCPv6 状態に変化すると、このコールバック関数によってアプリケーションに通知されます。</span><span class="sxs-lookup"><span data-stu-id="495d5-196">When the DHCPv6 Client changes to a new DHCPv6 state as a result of processing a DHCPv6 request, it notifies the application with this callback function.</span></span>

<span data-ttu-id="495d5-197">*nx_dhcpv6_server_error_handler*</span><span class="sxs-lookup"><span data-stu-id="495d5-197">*nx_dhcpv6_server_error_handler*</span></span>

<span data-ttu-id="495d5-198">DHCPv6 クライアントで、0 以外 (成功しなかった) の状態の "*状態*" オプションが含まれるサーバー応答が受信されると、サーバー エラー状態コードが含まれるこのコールバックによってアプリケーションに通知されます。</span><span class="sxs-lookup"><span data-stu-id="495d5-198">When the DHCPv6 Client receives a Server reply containing a *Status* option with a non-zero (non successful) status, it notifies the application with this callback which includes the Server error status code.</span></span>

<span data-ttu-id="495d5-199">注: これらのコールバック関数は、DHCPv6 クライアント スレッド タスクから呼び出されるため、DHCPv6 クライアントのミューテックス制御を必要とする NetX Duo DHCPv6 クライアント サービス (*nx_dhcpv6_start、nx_dhcpv6_stop,* など) や、コールバックから直接メッセージを送信する API (*nx_dhcpv6_request_release* など) を、クライアント アプリケーションから呼び出すことはできません。</span><span class="sxs-lookup"><span data-stu-id="495d5-199">Note: Since these callback functions are called from the DHCPv6 Client thread task, the Client application must NOT call any NetX Duo DHCPv6 Client services that require mutex control of the DHCPv6 Client such as *nx_dhcpv6_start, nx_dhcpv6_stop,* and any of the API that send messages directly from the callback e.g. *nx_dhcpv6_request_release*.</span></span>

## <a name="dhcpv6-rfcs"></a><span data-ttu-id="495d5-200">DHCPv6 の RFC</span><span class="sxs-lookup"><span data-stu-id="495d5-200">DHCPv6 RFCs</span></span>

<span data-ttu-id="495d5-201">NetX Duo DHCP は、RFC3315、RFC3646、および関連する RFC に準拠しています。</span><span class="sxs-lookup"><span data-stu-id="495d5-201">NetX Duo DHCP is compliant with RFC3315, RFC3646, and related RFCs.</span></span>