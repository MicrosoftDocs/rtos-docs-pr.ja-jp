---
title: スクリーン フローの定義
description: GUIX Studio は、スクリーン切り替えロジックの自動生成と実行をサポートしています。
author: philmea
ms.author: philmea
ms.date: 5/19/2020
ms.service: rtos
ms.topic: article
ms.openlocfilehash: 1df90acd86b4446d96a66ab3ee21545afcd9824e28efb40204c2966cb075c501
ms.sourcegitcommit: 93d716cf7e3d735b18246d659ec9ec7f82c336de
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/07/2021
ms.locfileid: "116785611"
---
# <a name="chapter-7-defining-screen-flow"></a>第 7 章 - スクリーン フローの定義

GUIX Studio は、スクリーン切り替えロジックの自動生成と実行をサポートしています。 ユーザーは、グラフィカルなスクリーン フロー ダイアグラムを作成および編集することによって、スクリーン切り替えロジックを定義します。 スクリーン フロー ダイアグラムをプロジェクトに追加すると、次の 2 つの重要な機能が有効になります。1) Studio 環境内からアプリケーションを実行する機能と、2) Studio が、生成された specifications.c ファイル内で、指定されたスクリーン フローを実装するイベント ハンドラーおよびスクリーン切り替えロジックを自動生成する機能で、これによりアプリケーション プログラムからこの負荷が排除されます。 

Studio 環境内からデスクトップ上でアプリケーションを実行する機能は、アプリケーションを実行するためにコンパイル/リンク サイクルを通過する必要がないという点で時間を節約でき便利です。 もちろん、アプリケーションをコンパイルせずにできることには制限があります。 カスタム描画関数、カスタム イベント ハンドラー、および複雑なイベント処理は、GUIX Studio 環境内からアプリケーションを実行しているときは使用できません。 それでも、この機能を使用すると、スクリーン切り替えロジックを自動生成できるほか、プログラム アニメーションを実行して、スクリーン間を切り替えることができます。 これらの効果とアニメーションは、GUIX Studio 環境内から直接確認できます。

以下の段落で説明するスクリーン フロー、トリガー、およびアクションを定義しているときは、Studio 環境内から UI 実行を有効にしているだけでなく、イベントを処理し、それらのイベントに基づいて、スクリーン切り替えなどのアクションを実行できるようにするロジックを、GUIX Studio が仕様ファイル内に生成していることに注意してください。

## <a name="configuring-screen-flow"></a>スクリーン フローの構成

アプリケーションを Studio 環境内から実行する前に、定義する必要があるものがいくつかあります。 まず、Studio のプロパティ ビュー内の "起動時に表示" プロパティを選択して、プログラムの起動時に表示される最上位のスクリーンを指定する必要があります。 このフラグは、プログラムの起動時にこのスクリーンが最初に表示されることを示します。 必要に応じて、複数のスクリーンでこのように指定できます。

起動時に表示されるスクリーンを定義したユーザーは、UI アプリケーションのスクリーンからスクリーンへのフローを定義できます。 GUIX Studio には、スクリーン切り替えロジックを定義するためのグラフィカル スクリーン フロー ダイアグラムが用意されています。 メニューの **構成、スクリーン フロー** を選択するだけで、スクリーン フロー編集ダイアログ (*_図 30_* のスクリーンショット) が表示されます。

![GUIX Studio のスクリーン フロー ダイアログのスクリーンショット。](./media/guix-studio/config_screen_flow.png)

**図 30**

プロジェクト内で定義されている最上位レベルの各スクリーンがボックスとして表示され、スクリーン名を示されています。 このボックスは、プロジェクト内で定義されている最上位レベルの各スクリーンを表すプレースホルダーです。 これらのボックスは、必要に応じて移動およびサイズ変更できます。 最上位レベル スクリーン間の切り替えが定義されている場合、そのスクリーン間の切り替えを示すために、2 つのスクリーンの間に矢印の接続線が表示されます。

スクリーンフロー ダイアグラムの左側のツリー ビューには各最上位レベル スクリーンが表示され、スクリーンフロー ダイアグラムに描画する最上位スクリーンを選択できます。

スクリーンフロー ダイアグラムはスクロールできます。 スクリーン ブロックを表示領域の外にドラッグすると、スクロール可能なウィンドウが拡大します。 拡大されたスクロール可能なウィンドウを表示領域に合わせて縮小するには、マウス ホイールを下にスクロールします。 スクロール可能なウィンドウが縮小されている場合は、マウス ホイールを上にスクロールすることで、すべてのブロックが収まる大きさにすることができます。

スクリーンの切り替えを定義するには、そのスクリーンのプレースホルダーを右クリックして [Edit Trigger List]\(トリガーの一覧の編集\) ダイアログを開きます。***図 31*** をご覧ください。

![GUIX Studio の [Edit Trigger List]\(トリガーの一覧の編集\) ダイアログのスクリーンショット。](./media/guix-studio/edit_trigger_list.png)

**図 31**

トリガーの編集ダイアログには、スクリーンの切り替えをトリガーする、ユーザーが定義したイベントが表示されます。このため、これらのイベントはトリガーと呼ばれています。 トリガーは、通常、選択したスクリーンの 1 つ以上の子ウィジェットによって生成されるシグナルです。

新しいトリガーを定義するには、[Edit Trigger List]\(トリガーの一覧の編集\) ダイアログ 内の **[新しいトリガーを追加]** ボタンを選択して、*_図 32_* に示されている [Add Trigger]\(トリガーの追加\) ダイアログを表示します。

![GUIX Studio の [Add Trigger]\(トリガーの追加\) ダイアログのスクリーンショット。](./media/guix-studio/add_trigger_for.png)

**図 32**

新しい一連のアクションをトリガーするイベントの種類を定義し、そのトリガー イベントを受け取ったときに実行されるアクションを定義できます。

新しいアニメーション スクリーンの切り替えのトリガーに使用するイベントの種類を定義して、この新しいトリガーを保存すると、そのトリガーは、[Edit Trigger List]\(トリガーの一覧の編集\) ダイアログに表示されます。

(実行する関連アクションを変更せずに) このイベントを変更するには、[Edit Trigger List]\(トリガーの一覧の編集\) ダイアログ内でイベントを選択し、***[Edit Trigger Event]\(トリガーイベントの編集\)*** ボタンを選択します。

同様に、一覧からトリガー イベントを削除するには、イベントを選択し、***[Delete Selected Trigger]\(選択したトリガーの削除\)*** ボタンをクリックします。

特定のトリガー イベントに基づいて発生するアニメーションまたはスクリーン切り替え効果を指定するには、そのトリガー イベントを選択し、***[アクションの編集]*** ボタンをクリックします。 定義されている各トリガーに基づいて複数のアクションを実行できることに注意してください。

**[アクションの編集]** ボタンをクリックすると、図 33 に示されている [Edit Actions for Trigger]\(トリガーのアクションの編集\) ダイアログが表示されます。 

![GUIX Studio の [Edit Actions for Trigger]\(トリガーのアクションの編集\) ダイアログのスクリーンショット。](./media/guix-studio/edit_actions_for_trigger.png)

**図 33**

このダイアログを使用すると、このトリガー イベントに基づいて実装する任意の数のアクションを定義できます。 各アクションにわかりやすい名前を付けると、各アクションの定義と、ビジュアル アニメーションまたは切り替えを関連付けるうえで役立ちます。 上記の例では、"fade_in_text_screen" と "fade_out_button_screen" という名前の 2 つのアクションを定義しました。

次に、実装する新しいアクションを定義し、[新しいアクションの追加] ボタンをクリックします。これにより、[アクションの選択] ダイアログ (図 34) が表示されます。

![GUIX Studio の [アクションの選択] ダイアログのスクリーンショット。](./media/guix-studio/select_action.png)

**図 34**

使用可能なアクションの種類は次のとおりです。

- **アニメーション**: 指定した情報を使用してアニメーションを開始します。
- **アタッチ**: ターゲット スクリーンを親スクリーンにアタッチします。親スクリーンが指定されていない場合、ターゲット スクリーンはルート ウィンドウにアタッチされます。
- **デタッチ**: ターゲット スクリーンをその親からデタッチします。
- **非表示**: ターゲット スクリーンを非表示にします。
- **スクリーン スタック ポップ**: 内部スクリーン スタックからスクリーンをポップします。
- **スクリーン スタック プッシュ**: スクリーン ポインターを内部スクリーン スタックにプッシュします。
- **スクリーン スタック リセット**: すべてのスクリーン ポインターを内部スクリーン スタックから削除します。
- **表示**: ターゲット スクリーンを表示します。
- **トグル**: ターゲット スクリーンを現在のスクリーンの親にアタッチします。また、現在のスクリーンをその親からデタッチします。
- **ウィンドウの実行**: モーダルでターゲット スクリーンを実行します。
- **ウィンドウ実行の停止**: 現在のスクリーンのモーダル実行を終了します。

選択したトリガー イベントに基づいて実行するアクションを定義すると、そのアクションは、[Edit Actions for Trigger]\(トリガーのアクションの編集\) ダイアログに表示されます。 図 35 に示すように、このアクションを選択して、そのアクションのパラメーターを変更することができます。

![GUIX Studio の [Edit Actions for Trigger]\(トリガーのアクションの編集\) ダイアログのスクリーンショット。](./media/guix-studio/edit_actions_for_trigger.png)

**図 35**

アクションの種類がアニメーションの場合は、右側に一連のアニメーション パラメーターが表示されます。ここで、実行するスライドまたはフェードの種類のアニメーションを定義できます。 アニメーション アクションが完了したら、アニメーションを親から自動的にデタッチするか、内部スクリーン スタックにプッシュするかを決定することもできます。これは、多くの場合、マルチレイヤー メニュー システムを定義するときに便利です。

スライド アニメーションおよびフェード アニメーションについては、[Easing Func Select]\(イージング関数選択\) ボタンを選択することで、使用するイージング関数を定義することもできます。 イージング関数は、実際の動きイベントをより正確に模倣するように設計されたさまざまな曲線です。 このボタンを選択すると、 **[Select Easing Function]\(イージング関数の選択\)** ダイアログが表示されます (図 36)。

![GUIX Studio の [Select Easing Function]\(イージング関数の選択\) ダイアログのスクリーンショット。](./media/guix-studio/easing_function_select.png)

**図 36**

複数のアクションが 1 つのトリガー イベントに関連付けられるように定義する場合は、各アクションにわかりやすい名前を付けると便利です。 アクション名は、生成された仕様ファイル内でのイベント テーブルとアクション テーブルの定義に使用されるため、C 構文の名前付け規則に従う必要があります。

GUIX Studio 内でトリガー イベントとアクションを定義すると、これらのイベントの処理と、指定したアクションの実行のために、自動イベント ハンドラーがご自身のプロジェクト仕様ファイル内に生成されます。 つまり、ご自身のアプリケーション コード内でこれらのイベントを処理する必要がありません。ただし、トリガー イベントは引き続き、定義した任意のカスタム イベント ハンドラーに渡されます。 言い換えれば、Studio で生成されたイベント ハンドラーは、独自のカスタム イベント ハンドラーを置き換えるのではなく拡張します。

## <a name="running-the-application"></a>アプリケーションの実行

起動スクリーンとスクリーン フロー ダイアグラムが作成された後、Studio 内でご自身のアプリケーションを実行するには、ツール バーの [アプリケーションの実行] を選択します。

![[アプリケーションの実行] ボタンのスクリーンショット。](./media/guix-studio/image68.jpg)

次に、プロジェクト メニューから [編集]、[アプリケーションの実行] の順に選択するか、[Edit Screen Flow]\(スクリーン フローの編集\) ダイアログの下部の [実行] ボタンを選択します。

アプリケーションを実行すると、新しいウィンドウ内に "起動時に表示" ディスプレイとして指定したスクリーンが表示されます。 これらのスクリーン上の子ウィジェットは完全に動作しています。 ボタンのクリック、スライダーの操作、ホイールのスクロールなどを行うことができます。 これらのウィジェットに対してカスタム描画関数または顧客イベント処理を定義した場合、このモードでアプリケーションを実行しているときは、もちろんこれは表示されません。 ただし、トリガー イベントとアクションを含むスクリーン フロー ダイアグラムを定義した場合、それらのトリガーは動作し、定義したとおりにスクリーンが切り替わります (定義した可能性のあるアニメーションを含む)。
