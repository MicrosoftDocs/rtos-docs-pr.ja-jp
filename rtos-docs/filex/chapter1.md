---
title: 第 1 章 - Azure RTOS FileX の概要
description: Azure RTOS FileX は、深く埋め込まれたアプリケーション用の完全な FAT 形式のメディアおよびファイル管理システムです。
author: philmea
ms.author: philmea
ms.date: 05/19/2020
ms.topic: article
ms.service: rtos
ms.openlocfilehash: be7e6f9cd9fbc69ac0908d1de733dac1c4f73bf6
ms.sourcegitcommit: e3d42e1f2920ec9cb002634b542bc20754f9544e
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 03/22/2021
ms.locfileid: "104810334"
---
# <a name="chapter-1---introduction-to-azure-rtos-filex"></a><span data-ttu-id="7d369-103">第 1 章 - Azure RTOS FileX の概要</span><span class="sxs-lookup"><span data-stu-id="7d369-103">Chapter 1 - Introduction to Azure RTOS FileX</span></span>

<span data-ttu-id="7d369-104">Azure RTOS FileX は、深く埋め込まれたアプリケーション用の完全な FAT 形式のメディアおよびファイル管理システムです。</span><span class="sxs-lookup"><span data-stu-id="7d369-104">Azure RTOS FileX is a complete FAT format media and file management system for deeply embedded applications.</span></span> <span data-ttu-id="7d369-105">この章では、FileX の概要と、そのアプリケーションおよび利点について説明します。</span><span class="sxs-lookup"><span data-stu-id="7d369-105">This chapter introduces FileX, describing its applications and benefits.</span></span>

## <a name="filex-unique-features"></a><span data-ttu-id="7d369-106">FileX の固有の機能</span><span class="sxs-lookup"><span data-stu-id="7d369-106">FileX Unique Features</span></span>

<span data-ttu-id="7d369-107">Azure RTOS FileX では、RAM ディスク、FLASH マネージャー、実際の物理デバイスなど、無制限の数のメディア デバイスが同時にサポートされています。</span><span class="sxs-lookup"><span data-stu-id="7d369-107">Azure RTOS FileX supports an unlimited number of media devices at the same time, including RAM disks, FLASH managers, and actual physical devices.</span></span> <span data-ttu-id="7d369-108">12 ビット、16 ビット、32 ビットのファイル アロケーション テーブル (FAT) 形式がサポートされています。また、拡張ファイル アロケーション テーブル (exFAT) と連続したファイルの割り当てもサポートされており、サイズとパフォーマンスの両方について高度に最適化されています。</span><span class="sxs-lookup"><span data-stu-id="7d369-108">It supports 12-, 16-, and 32-bit File Allocation Table (FAT) formats, and also supports Extended File Allocation Table (exFAT), contiguous file allocation, and is highly optimized for both size and performance.</span></span> <span data-ttu-id="7d369-109">FileX には、フォールト トレラントのサポート、メディアのオープンとクローズ、ファイル書き込みコールバック関数も含まれています。</span><span class="sxs-lookup"><span data-stu-id="7d369-109">FileX also includes fault tolerant support, media open/ close, and file write callback functions.</span></span>

<span data-ttu-id="7d369-110">FileX は、拡大する FLASH デバイスのニーズを満たすように設計されており、ThreadX と同じ設計とコーディングの方法が使用されています。</span><span class="sxs-lookup"><span data-stu-id="7d369-110">Designed to meet the growing need for FLASH devices, FileX uses the same design and coding methods as ThreadX.</span></span> <span data-ttu-id="7d369-111">すべての Microsoft 製品と同様に、FileX と共に完全な ANSI C ソース コードが配布されており、実行時のロイヤリティはありません。</span><span class="sxs-lookup"><span data-stu-id="7d369-111">Like all Microsoft products, FileX is distributed with full ANSI C source code, and it has no run-time royalties.</span></span>

### <a name="product-highlights"></a><span data-ttu-id="7d369-112">製品の特徴</span><span class="sxs-lookup"><span data-stu-id="7d369-112">Product Highlights</span></span>

- <span data-ttu-id="7d369-113">ThreadX プロセッサの完全なサポート</span><span class="sxs-lookup"><span data-stu-id="7d369-113">Complete ThreadX processor support</span></span>
- <span data-ttu-id="7d369-114">ロイヤリティなし</span><span class="sxs-lookup"><span data-stu-id="7d369-114">No royalties</span></span>
- <span data-ttu-id="7d369-115">完全な ANSI C ソース コード</span><span class="sxs-lookup"><span data-stu-id="7d369-115">Complete ANSI C source code</span></span>
- <span data-ttu-id="7d369-116">リアルタイムのパフォーマンス</span><span class="sxs-lookup"><span data-stu-id="7d369-116">Real-time performance</span></span>
- <span data-ttu-id="7d369-117">すばやく対応するテクニカル サポート</span><span class="sxs-lookup"><span data-stu-id="7d369-117">Responsive technical support</span></span>
- <span data-ttu-id="7d369-118">無制限の FileX オブジェクト (メディア、ディレクトリ、ファイル)</span><span class="sxs-lookup"><span data-stu-id="7d369-118">Unlimited FileX objects (media, directories, and files)</span></span>
- <span data-ttu-id="7d369-119">FileX オブジェクトの動的な作成と削除</span><span class="sxs-lookup"><span data-stu-id="7d369-119">Dynamic FileX object creation/deletion</span></span>
- <span data-ttu-id="7d369-120">柔軟なメモリの使用</span><span class="sxs-lookup"><span data-stu-id="7d369-120">Flexible memory usage</span></span>
- <span data-ttu-id="7d369-121">サイズの自動スケーリング</span><span class="sxs-lookup"><span data-stu-id="7d369-121">Size scales automatically</span></span>
- <span data-ttu-id="7d369-122">小さいフットプリント (最小 6 KB) の命令領域サイズ: 6 - 30 K</span><span class="sxs-lookup"><span data-stu-id="7d369-122">Small footprint (as low as 6 KBytes) instruction area size: 6-30K</span></span>
- <span data-ttu-id="7d369-123">ThreadX との完全な統合</span><span class="sxs-lookup"><span data-stu-id="7d369-123">Complete integration with ThreadX</span></span>
- <span data-ttu-id="7d369-124">エンディアン ニュートラル</span><span class="sxs-lookup"><span data-stu-id="7d369-124">Endian neutral</span></span>
- <span data-ttu-id="7d369-125">簡単に実装できる FileX I/O ドライバー</span><span class="sxs-lookup"><span data-stu-id="7d369-125">Easy-to-implement FileX I/O drivers</span></span>
- <span data-ttu-id="7d369-126">12、16、32 ビットの FAT のサポート</span><span class="sxs-lookup"><span data-stu-id="7d369-126">12-, 16-, and 32-bit FAT support</span></span>
- <span data-ttu-id="7d369-127">exFAT のサポート</span><span class="sxs-lookup"><span data-stu-id="7d369-127">exFAT support</span></span>
- <span data-ttu-id="7d369-128">長いファイル名のサポート</span><span class="sxs-lookup"><span data-stu-id="7d369-128">Long filename support</span></span>
- <span data-ttu-id="7d369-129">内部 FAT エントリ キャッシュ</span><span class="sxs-lookup"><span data-stu-id="7d369-129">Internal FAT entry cache</span></span>
- <span data-ttu-id="7d369-130">Unicode 名のサポート</span><span class="sxs-lookup"><span data-stu-id="7d369-130">Unicode name support</span></span>
- <span data-ttu-id="7d369-131">連続したファイルの割り当て</span><span class="sxs-lookup"><span data-stu-id="7d369-131">Contiguous file allocation</span></span>
- <span data-ttu-id="7d369-132">連続するセクターとクラスターの読み取りと書き込み</span><span class="sxs-lookup"><span data-stu-id="7d369-132">Consecutive sector and cluster read/write</span></span>
- <span data-ttu-id="7d369-133">内部論理セクターのキャッシュ</span><span class="sxs-lookup"><span data-stu-id="7d369-133">Internal logical sector cache</span></span>
- <span data-ttu-id="7d369-134">すぐに実行できる RAM ディスクのデモ</span><span class="sxs-lookup"><span data-stu-id="7d369-134">RAM disk demonstration runs out-of-the-box</span></span>
- <span data-ttu-id="7d369-135">メディア フォーマット機能</span><span class="sxs-lookup"><span data-stu-id="7d369-135">Media format capability</span></span>
- <span data-ttu-id="7d369-136">エラーの検出と回復</span><span class="sxs-lookup"><span data-stu-id="7d369-136">Error detection and recovery</span></span>
- <span data-ttu-id="7d369-137">フォールト トレラント オプション</span><span class="sxs-lookup"><span data-stu-id="7d369-137">Fault tolerant options</span></span>
- <span data-ttu-id="7d369-138">組み込みのパフォーマンス統計情報</span><span class="sxs-lookup"><span data-stu-id="7d369-138">Built-in performance statistics</span></span>
- <span data-ttu-id="7d369-139">スタンドアロンのサポート (Azure RTOS なし)</span><span class="sxs-lookup"><span data-stu-id="7d369-139">Standalone support (No Azure RTOS)</span></span>

## <a name="safety-certifications"></a><span data-ttu-id="7d369-140">安全性の認定</span><span class="sxs-lookup"><span data-stu-id="7d369-140">Safety Certifications</span></span>

### <a name="tv-certification"></a><span data-ttu-id="7d369-141">TÜV 認定</span><span class="sxs-lookup"><span data-stu-id="7d369-141">TÜV Certification</span></span>

<span data-ttu-id="7d369-142">FileX は、IEC-61508 および IEC-62304 に従って、安全性が重要なシステムでの使用を SGS-TÜV Saar によって認定されています。</span><span class="sxs-lookup"><span data-stu-id="7d369-142">FileX has been certified by SGS-TÜV Saar for use in safety-critical systems, according to IEC-61508 and IEC-62304.</span></span> <span data-ttu-id="7d369-143">この認定により、「電気・電子・プログラマブル電子安全関連系の機能安全」に関する国際電気標準会議 (IEC) 61508 および IEC 62304 の安全性の最高レベルに対応する安全関連ソフトウェアの開発で FileX を使用できることが確認されています。</span><span class="sxs-lookup"><span data-stu-id="7d369-143">The certification confirms that FileX can be used in the development of safety-related software for the highest safety integrity levels of the International Electrotechnical Commission (IEC) 61508 and IEC 62304, for the "Functional Safety of electrical, electronic, and programmable electronic safety-related systems."</span></span> <span data-ttu-id="7d369-144">ドイツの SGS-Group と TÜV Saarland の共同事業を通じて結成された SGS-TÜV Saar は、世界中の安全関連システムのための組み込みソフトウェアのテスト、監査、検証、認定を行う、世界有数の公認された独立系企業になりました。</span><span class="sxs-lookup"><span data-stu-id="7d369-144">SGS-TÜV Saar, formed through a joint venture of Germany's SGS-Group and TÜV Saarland, has become the leading accredited, independent company for testing, auditing, verifying, and certifying embedded software for safety-related systems worldwide.</span></span> <span data-ttu-id="7d369-145">工業安全規格の IEC 61508 と、それから派生したすべての標準 (IEC 62304 を含む) は、電気・電子・プログラマブル電子安全関連の医療デバイス、プロセス制御システム、工業機械、鉄道制御システムの機能安全を保証するために使用されます。</span><span class="sxs-lookup"><span data-stu-id="7d369-145">The industrial safety standard IEC 61508, and all standards that are derived from it, including IEC 62304, are used to assure the functional safety of electrical, electronic, and programmable electronic safety-related medical devices, process control systems, industrial machinery, and railway control systems.</span></span>

<span data-ttu-id="7d369-146">SGS-TÜV Saar は、ISO 26262 標準に従って、安全性が重要な自動車システムで FileX を使用することを認可しました。</span><span class="sxs-lookup"><span data-stu-id="7d369-146">SGS-TÜV Saar has certified FileX to be used in safety-critical automotive systems, according to the ISO 26262 standard.</span></span> <span data-ttu-id="7d369-147">さらに、FileX は、ISO 26262 認定の最高レベルを表す Automotive Safety Integrity Level (ASIL) D に認定されています。</span><span class="sxs-lookup"><span data-stu-id="7d369-147">Furthermore, FileX is certified to Automotive Safety Integrity Level (ASIL) D, which represents the highest level of ISO 26262 certification.</span></span>

<span data-ttu-id="7d369-148">さらに、SGS-TÜV Saar では、FileX が SW-SIL 4 までの EN 50128 標準を満たしており、安全性が重要な鉄道アプリケーションで使用できるものとして認定しています。</span><span class="sxs-lookup"><span data-stu-id="7d369-148">In addition, SGS-TÜV Saar has certified FileX to be used in safety-critical railway applications, meeting to the EN 50128 standard up to SW-SIL 4.</span></span>

![SGS-TUV Saar のロゴ](./media/user-guide/sgs-tuv-saar-logo.png)

- <span data-ttu-id="7d369-150">IEC 61508 (SIL 4 まで)</span><span class="sxs-lookup"><span data-stu-id="7d369-150">IEC 61508 up to SIL 4</span></span>
- <span data-ttu-id="7d369-151">IEC 62304 (SW 安全性クラス C まで)</span><span class="sxs-lookup"><span data-stu-id="7d369-151">IEC 62304 up to SW safety Class C</span></span>
- <span data-ttu-id="7d369-152">ISO 26262 ASIL D</span><span class="sxs-lookup"><span data-stu-id="7d369-152">ISO 26262 ASIL D</span></span>
- <span data-ttu-id="7d369-153">EN 50128 SW-SIL 4</span><span class="sxs-lookup"><span data-stu-id="7d369-153">EN 50128 SW-SIL 4</span></span>

> [!IMPORTANT]
> <span data-ttu-id="7d369-154">TÜV によって認定されている FileX のバージョンに関する情報や、テスト レポート、証明書、関連ドキュメントの入手については、Microsoft までお問い合わせください。\*</span><span class="sxs-lookup"><span data-stu-id="7d369-154">Please contact us for more information on which version(s) of FileX have been certified by TÜV or for the availability of test reports, certificates, and associated documentation.\*</span></span>

### <a name="ul-certification"></a><span data-ttu-id="7d369-155">UL 認定</span><span class="sxs-lookup"><span data-stu-id="7d369-155">UL Certification</span></span>

<span data-ttu-id="7d369-156">FileX は、プログラマブル コンポーネント内のソフトウェアに対する UL 60730-1 付属文書 H、CSA E60730-1 付属文書 H、IEC 60730-1 付属文書 H、UL 60335-1 付属文書 R、IEC 603351 付属文書 R、UL 1998 の各安全標準に準拠しているものとして UL によって認定されています。</span><span class="sxs-lookup"><span data-stu-id="7d369-156">FileX has been certified by UL for compliance with UL 60730-1 Annex H, CSA E60730-1 Annex H, IEC  60730-1 Annex H, UL 60335-1 Annex R, IEC 603351 Annex R, and UL 1998 safety standards for software in programmable components.</span></span> <span data-ttu-id="7d369-157">IEC/UL 60730-1 (付属文書 H に「ソフトウェアを使用した制御」に対する要件がある) と共に、IEC 60335-1 標準では、「プログラマブル電子回路」に対する要件がその付属文書 R で説明されています。IEC 60730 付属文書 R と IEC 60335-1 付属文書 R では、洗濯機、乾燥機、冷蔵庫、冷凍庫、オーブンなどのアプライアンスで使用される MCU のハードウェアとソフトウェアの安全性が取り上げられています。</span><span class="sxs-lookup"><span data-stu-id="7d369-157">Along with IEC/UL 60730-1, which has requirements for  "Controls Using Software" in its Annex H, the IEC 60335-1 standard describes the requirements for "Programmable Electronic Circuits" in its Annex R. IEC 60730 Annex H and IEC 60335-1 Annex R address the safety of MCU hardware and software used in appliances such as washing machines, dishwashers, dryers, refrigerators, freezers, and ovens.</span></span>

![C RU US 2](./media/user-guide/c-ru-us-logo.png)

<span data-ttu-id="7d369-159">*UL/IEC 60730、UL/IEC 60335、UL 1998*</span><span class="sxs-lookup"><span data-stu-id="7d369-159">*UL/IEC 60730, UL/IEC 60335, UL 1998*</span></span>

> [!IMPORTANT]
><span data-ttu-id="7d369-160">*UL によって認定されている FileX のバージョンに関する情報や、テスト レポート、証明書、関連ドキュメントの入手については、Microsoft までお問い合わせください。*</span><span class="sxs-lookup"><span data-stu-id="7d369-160">*Please contact us for more information on which version(s) of FileX have been certified by UL or for the availability of test reports, certificates, and associated documentation.*</span></span>

## <a name="powerful-services-of-filex"></a><span data-ttu-id="7d369-161">FileX の強力なサービス</span><span class="sxs-lookup"><span data-stu-id="7d369-161">Powerful Services of FileX</span></span>

### <a name="multiple-media-management"></a><span data-ttu-id="7d369-162">複数のメディア管理</span><span class="sxs-lookup"><span data-stu-id="7d369-162">Multiple Media Management</span></span>

<span data-ttu-id="7d369-163">FileX でサポートできる物理メディアの数に制限はありません。</span><span class="sxs-lookup"><span data-stu-id="7d369-163">FileX can support an unlimited number of physical media.</span></span> <span data-ttu-id="7d369-164">各メディア インスタンスには、***fx_media_open*** の呼び出しで指定された、独自のメモリ領域と関連ドライバーがあります。</span><span class="sxs-lookup"><span data-stu-id="7d369-164">Each media instance has its own distinct memory area and associated driver specified on the ***fx_media_open*** call.</span></span> <span data-ttu-id="7d369-165">FileX の既定のディストリビューションには、簡単な RAM メディア ドライバーと、この RAM ディスクを使用するデモ システムが付属しています。</span><span class="sxs-lookup"><span data-stu-id="7d369-165">The default distribution of FileX comes with a simple RAM media driver and a demonstration system that uses this RAM disk.</span></span>

### <a name="logical-sector-cache"></a><span data-ttu-id="7d369-166">論理セクター キャッシュ</span><span class="sxs-lookup"><span data-stu-id="7d369-166">Logical Sector Cache</span></span>

<span data-ttu-id="7d369-167">FileX 論理セクター キャッシュによって、メディアとの間の両方向のセクター転送の数が減るため、パフォーマンスが大幅に向上します。</span><span class="sxs-lookup"><span data-stu-id="7d369-167">By reducing the number of whole sector transfers, both to and from the media, the FileX logical sector cache significantly improves performance.</span></span> <span data-ttu-id="7d369-168">開かれているメディアごとに、FileX によって論理セクター キャッシュが保持されます。</span><span class="sxs-lookup"><span data-stu-id="7d369-168">FileX maintains a logical sector cache for each opened media.</span></span> <span data-ttu-id="7d369-169">論理セクター キャッシュの深さは、***fx_media_open*** API の呼び出しで FileX に提供されるメモリの量によって決まります。</span><span class="sxs-lookup"><span data-stu-id="7d369-169">The depth of the logical sector cache is determined by the amount of memory supplied to FileX with the ***fx_media_open*** API call.</span></span>

### <a name="contiguous-file-support"></a><span data-ttu-id="7d369-170">連続ファイルのサポート</span><span class="sxs-lookup"><span data-stu-id="7d369-170">Contiguous File Support</span></span>

<span data-ttu-id="7d369-171">FileX によって API サービス ***fx_file_allocate*** を通して連続したファイルのサポートが提供され、ファイル アクセス時間が向上して、決定論的になります。</span><span class="sxs-lookup"><span data-stu-id="7d369-171">FileX offers contiguous file support through the API service ***fx_file_allocate*** to improve and make file access time deterministic.</span></span> <span data-ttu-id="7d369-172">このルーチンは、必要なメモリの量を受け取り、要求を満たす一連の隣接するクラスターを検索します。</span><span class="sxs-lookup"><span data-stu-id="7d369-172">This routine takes the amount of memory requested and looks for a series of adjacent clusters to satisfy the request.</span></span> <span data-ttu-id="7d369-173">そのようなクラスターが見つかった場合は、割り当て済みクラスターのファイル チェーンの一部にすることによって、事前に割り当てられます。</span><span class="sxs-lookup"><span data-stu-id="7d369-173">If such clusters are found, they are pre-allocated by making them part of the file's chain of allocated clusters.</span></span> <span data-ttu-id="7d369-174">物理メディアを移動する場合、FileX の連続したファイルのサポートによってパフォーマンスが大幅に向上し、アクセス時間が決定論的になります。</span><span class="sxs-lookup"><span data-stu-id="7d369-174">On moving physical media, the FileX contiguous file support results in a significant performance improvement and makes the access time deterministic.</span></span>

### <a name="dynamic-creation"></a><span data-ttu-id="7d369-175">動的作成</span><span class="sxs-lookup"><span data-stu-id="7d369-175">Dynamic Creation</span></span>

<span data-ttu-id="7d369-176">FileX を使用すると、システム リソースを動的に作成できます。</span><span class="sxs-lookup"><span data-stu-id="7d369-176">FileX allows you to create system resources dynamically.</span></span> <span data-ttu-id="7d369-177">これは、アプリケーションに複数の構成要件または動的な構成要件がある場合に特に重要です。</span><span class="sxs-lookup"><span data-stu-id="7d369-177">This is especially important if your application has multiple or dynamic configuration requirements.</span></span> <span data-ttu-id="7d369-178">さらに、使用できる FileX リソース (メディアまたはファイル) の数に、あらかじめ決められた制限はありません。</span><span class="sxs-lookup"><span data-stu-id="7d369-178">In addition, there are no predetermined limits on the number of FileX resources you can use (media or files).</span></span> <span data-ttu-id="7d369-179">また、システム オブジェクトの数によってパフォーマンスが影響を受けることはありません。</span><span class="sxs-lookup"><span data-stu-id="7d369-179">Also, the number of system objects does not have any impact on performance.</span></span>

## <a name="easy-to-use-api"></a><span data-ttu-id="7d369-180">使いやすい API</span><span class="sxs-lookup"><span data-stu-id="7d369-180">Easy-to-use API</span></span>

<span data-ttu-id="7d369-181">FileX により、わかりやすく使いやすい方法で、非常に優れた深く埋め込まれたファイル システム テクノロジが提供されます。</span><span class="sxs-lookup"><span data-stu-id="7d369-181">FileX provides the very best deeply embedded file system technology in a manner that is easy to understand and easy to use!</span></span> <span data-ttu-id="7d369-182">FileX のアプリケーション プログラミング インターフェイス (API) を使用すると、サービスが直観的で一貫したものになります。</span><span class="sxs-lookup"><span data-stu-id="7d369-182">The FileX Application Programming Interface (API) makes the services intuitive and consistent.</span></span> <span data-ttu-id="7d369-183">他のファイル システムではよくある "略語だらけ" のサービスを解読する必要はありません。</span><span class="sxs-lookup"><span data-stu-id="7d369-183">You won't have to decipher "alphabet soup" services that are all too common with other file systems.</span></span>

<span data-ttu-id="7d369-184">FileX バージョン 5 のサービスの完全な一覧については、「[付録 A](appendix-a.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="7d369-184">For a complete list of the FileX Version 5 Services, see [Appendix A](appendix-a.md).</span></span>

## <a name="exfat-support"></a><span data-ttu-id="7d369-185">exFAT のサポート</span><span class="sxs-lookup"><span data-stu-id="7d369-185">exFAT Support</span></span>

<span data-ttu-id="7d369-186">exFAT (拡張ファイル アロケーション テーブル) は、Microsoft によって設計されたファイル システムであり、FAT32 ファイル システムによる 2 GB の制限を超えるファイル サイズが許可されます。</span><span class="sxs-lookup"><span data-stu-id="7d369-186">exFAT (extended File Allocation Table) is a file system designed by Microsoft to allow file size to exceed 2GB, a limit imposed by FAT32 file systems.</span></span> <span data-ttu-id="7d369-187">これは、容量が 32 GB を超える SD カードの既定のファイル システムです。</span><span class="sxs-lookup"><span data-stu-id="7d369-187">It is the default file system for SD cards with capacity over 32GB.</span></span> <span data-ttu-id="7d369-188">FileX exFAT 形式でフォーマットされた SD カードまたはフラッシュ ドライブは、Windows と互換性があります。</span><span class="sxs-lookup"><span data-stu-id="7d369-188">SD cards or flash drives formatted with FileX exFAT format are compatible with Windows.</span></span> <span data-ttu-id="7d369-189">exFAT によって、最大 1 エクサバイト (EB) (約 10 億 GB) のファイル サイズがサポートされます。</span><span class="sxs-lookup"><span data-stu-id="7d369-189">exFAT supports file size up to one Exabyte (EB), which is approximately one billion GB.</span></span>

<span data-ttu-id="7d369-190">exFAT を使用するユーザーは、シンボル \***FX_ENABLE_EXFAT** _ を定義して FileX ライブラリを再コンパイルする必要があります。</span><span class="sxs-lookup"><span data-stu-id="7d369-190">Users wishing to use exFAT must recompile the FileX library with the symbol \***FX_ENABLE_EXFAT** _ defined.</span></span> <span data-ttu-id="7d369-191">メディアを開くと、FileX によってメディアの種類が検出されます。</span><span class="sxs-lookup"><span data-stu-id="7d369-191">When opening media, FileX detects the media type.</span></span> <span data-ttu-id="7d369-192">メディアが exFAT でフォーマットされている場合、FileX により exFAT 標準に従ってファイル システムの読み取りと書き込みが行われます。</span><span class="sxs-lookup"><span data-stu-id="7d369-192">If the media is formatted with exFAT, FileX reads and writes the file system following exFAT standard.</span></span> <span data-ttu-id="7d369-193">新しいメディアを exFAT でフォーマットするには、サービス _*_fx_media_exFAT_format_*\* を使用します。</span><span class="sxs-lookup"><span data-stu-id="7d369-193">To format new media with exFAT, use the service _\*_fx_media_exFAT_format_\*\*.</span></span> <span data-ttu-id="7d369-194">exFAT は既定では無効になっています。</span><span class="sxs-lookup"><span data-stu-id="7d369-194">By default exFAT is not enabled.</span></span>

## <a name="fault-tolerant-support"></a><span data-ttu-id="7d369-195">フォールト トレラントのサポート</span><span class="sxs-lookup"><span data-stu-id="7d369-195">Fault Tolerant Support</span></span>

<span data-ttu-id="7d369-196">FileX のフォールト トレラント モジュールは、ファイルまたはディレクトリの更新中の中断によってファイル システムが破損しないように設計されています。</span><span class="sxs-lookup"><span data-stu-id="7d369-196">The FileX Fault Tolerant Module is designed to prevent file system corruption caused by interruptions during the file or directory update.</span></span> <span data-ttu-id="7d369-197">たとえば、ファイルにデータを追加する場合、FileX は、ファイルの内容、ディレクトリ エントリ、および場合によっては FAT エントリを更新する必要があります。</span><span class="sxs-lookup"><span data-stu-id="7d369-197">For example, when appending data to a file, FileX needs to update the content of the file, the directory entry, and possibly the FAT entries.</span></span> <span data-ttu-id="7d369-198">この更新シーケンスが中断された場合 (電源障害や、更新の途中でメディアが取り出された場合など)、ファイル システムが一貫性のない状態になり、ファイル システム全体の整合性に影響を与える可能性があります。これは、他のファイルの破損につながる可能性があります。</span><span class="sxs-lookup"><span data-stu-id="7d369-198">If this sequence of update is interrupted (such as power glitch, or the media is ejected in the middle of the update), the file system is in an inconsistent state, which may affect the integrity of the entire file system, leading towards corruption of other files.</span></span>

<span data-ttu-id="7d369-199">FileX のフォールト トレラント モジュールの機能によって、ファイルまたはディレクトリを更新する過程で必要なすべての手順が記録されます。</span><span class="sxs-lookup"><span data-stu-id="7d369-199">The FileX Fault Tolerant Module works by recording all steps required to update a file or a directory along the way.</span></span> <span data-ttu-id="7d369-200">このログ エントリは、メディア上の FileX で検出してアクセスできる専用のセクター (ブロック) に格納されます。</span><span class="sxs-lookup"><span data-stu-id="7d369-200">This log entry is stored on the media in dedicated sectors (blocks) that FileX can find and access.</span></span> <span data-ttu-id="7d369-201">ログ データの場所には、適切なファイル システムがなくてもアクセスできます。</span><span class="sxs-lookup"><span data-stu-id="7d369-201">The location of the log data can be accessed even without a proper file system.</span></span> <span data-ttu-id="7d369-202">したがって、ファイル システムが破損した場合でも、FileX でログ エントリを見つけて、ファイル システムを正常な状態に戻すことができます。</span><span class="sxs-lookup"><span data-stu-id="7d369-202">Therefore, in case the file system is corrupted, FileX is still able to find the log entry and restore the file system back into a good state.</span></span>

<span data-ttu-id="7d369-203">FileX によってファイルまたはディレクトリが更新されると、ログ エントリが作成されます。</span><span class="sxs-lookup"><span data-stu-id="7d369-203">As FileX updates file or directory, log entries are created.</span></span> <span data-ttu-id="7d369-204">更新操作が正常に完了すると、ログ エントリは削除されます。</span><span class="sxs-lookup"><span data-stu-id="7d369-204">After the update operation is successfully completed, the log entries are removed.</span></span> <span data-ttu-id="7d369-205">ファイルの更新が正常に完了した後でログ エントリが適切に削除されず、復旧プロセスによって、ログ エントリの内容がファイル システムと一致すると判断された場合、実行する必要があることは何もなく、ログ エントリはクリーンアップできます。</span><span class="sxs-lookup"><span data-stu-id="7d369-205">If the log entries were not properly removed after a successful file update, if the recovery process determines that the content in the log entry matches the file system, nothing needs to be done, and the log entries can be cleaned up.</span></span>

<span data-ttu-id="7d369-206">ファイル システムの更新操作が中断された場合は、FileX で次にメディアがマウントされるときに、フォールト トレラント モジュールによってログ エントリが分析されます。</span><span class="sxs-lookup"><span data-stu-id="7d369-206">In case the file system update operation was interrupted, next time the media is mounted by FileX, the Fault Tolerant Module analyzes the log entries.</span></span> <span data-ttu-id="7d369-207">FileX は、ログ エントリ内の情報を使用して、ファイル システムに既に適用されている部分的な変更を取り消すことができます (ファイル更新操作の初期段階でエラーが発生した場合)。または、ログ エントリに再実行情報が含まれている場合は、FileX は前の操作を完了するために必要な変更を適用できます。</span><span class="sxs-lookup"><span data-stu-id="7d369-207">The information in the log entries allows FileX to back out partial changes already applied to the file system (in case the failure happens during the early stage of the file update operation), or if the log entries contain re-do information, FileX is able to apply the changes required to finish the prior operation.</span></span>

<span data-ttu-id="7d369-208">このフォールト トレラント機能は、FileX でサポートされているすべての FAT ファイル システム (FAT12、FAT16、FAT32、exFAT など) で使用できます。</span><span class="sxs-lookup"><span data-stu-id="7d369-208">This fault tolerant feature is available to all FAT file systems supported by FileX, including FAT12, FAT16, FAT32, and exFAT.</span></span> <span data-ttu-id="7d369-209">既定では、FileX のフォールト トレラントは有効になっていません。</span><span class="sxs-lookup"><span data-stu-id="7d369-209">By default fault tolerant is not enabled in FileX.</span></span> <span data-ttu-id="7d369-210">フォールト トレラント機能を有効にするには、シンボル **FX_ENABLE_FAULT_TOLERANT** と **FX_FAULT_TOLERANT** を定義して FileX をビルドする必要があります。</span><span class="sxs-lookup"><span data-stu-id="7d369-210">To enable the fault tolerant feature, FileX must be built with the symbol  **FX_ENABLE_FAULT_TOLERANT** and **FX_FAULT_TOLERANT** defined.</span></span> <span data-ttu-id="7d369-211">実行時には、アプリケーションにより **_fx_fault_tolerant_enable_** を呼び出すことにより、フォールト トレラント サービスが開始されます。</span><span class="sxs-lookup"><span data-stu-id="7d369-211">At run time, the application starts fault tolerant service by calling **_fx_fault_tolerant_enable_**.</span></span>
<span data-ttu-id="7d369-212">サービスが開始した後、ファイルとディレクトリのすべての書き込み操作は、フォールト トレラント モジュールを経由して行われます。</span><span class="sxs-lookup"><span data-stu-id="7d369-212">After the service starts, all file and directory write operations go through the Fault Tolerant Module.</span></span>

<span data-ttu-id="7d369-213">開始されたフォールト トレラント サービスにより、最初に、そのメディアがフォールト トレラント モジュールで保護されているかどうかが検出されます。</span><span class="sxs-lookup"><span data-stu-id="7d369-213">As fault tolerant service starts, it first detects whether or not the media is protected under the Fault Tolerant Module.</span></span> <span data-ttu-id="7d369-214">そうでない場合、ファイル システムの整合性の維持は FileX によって行われ、ファイル システムからログとキャッシュに使用される空きブロックが割り当てられて保護が開始されます。</span><span class="sxs-lookup"><span data-stu-id="7d369-214">If it is not, FileX assumes integrity of the file system, and starts protection by allocating free blocks from the file system to be used for logging and caching.</span></span> <span data-ttu-id="7d369-215">ファイル システムにフォールト トレラント モジュールのログが見つかった場合は、そのログ エントリが分析されます。</span><span class="sxs-lookup"><span data-stu-id="7d369-215">If the Fault Tolerant Module logs are found on the file system, it analyzes the log entries.</span></span> <span data-ttu-id="7d369-216">ログ エントリの内容に応じて、FileX により、前の操作が元に戻されるか、前の操作がやり直されます。</span><span class="sxs-lookup"><span data-stu-id="7d369-216">FileX reverts the prior operation or redoes the prior operation, depending on the content of the log entries.</span></span> <span data-ttu-id="7d369-217">以前のすべてのログ エントリが処理された後、ファイル システムは使用できるようになります。</span><span class="sxs-lookup"><span data-stu-id="7d369-217">The file system becomes available after all the prior log entries are processed.</span></span> <span data-ttu-id="7d369-218">これにより、FIleX が既知の正常な状態から開始することが保証されます。</span><span class="sxs-lookup"><span data-stu-id="7d369-218">This ensures that FIleX starts from a known good state.</span></span>

<span data-ttu-id="7d369-219">FileX のフォールト トレラント モジュールによってメディアが保護されるようになった後、メディアは別のファイル システムでは更新されません。</span><span class="sxs-lookup"><span data-stu-id="7d369-219">After a media is protected under the FileX Fault Tolerant Module, the media will not be updated with another file system.</span></span> <span data-ttu-id="7d369-220">それを行うと、ファイル システム上のログ エントリは、FAT テーブルのディレクトリ エントリの内容と整合性がなくなります。</span><span class="sxs-lookup"><span data-stu-id="7d369-220">Doing so would leave the log entries on the file system inconsistent with the contents in the FAT table, the directory entry.</span></span> <span data-ttu-id="7d369-221">フォールト トレラント モジュールによって FileX に戻される前に、別のファイル システムによってメディアが更新された場合、結果は未定義になります。</span><span class="sxs-lookup"><span data-stu-id="7d369-221">If the media is updated by another file system before moving it back to FileX with the Fault Tolerant Module, the result is undefined.</span></span>

## <a name="callback-functions"></a><span data-ttu-id="7d369-222">コールバック関数</span><span class="sxs-lookup"><span data-stu-id="7d369-222">Callback Functions</span></span>

<span data-ttu-id="7d369-223">次の 3 つのコールバック関数が FileX に追加されます。</span><span class="sxs-lookup"><span data-stu-id="7d369-223">The following three callback functions are added to FileX:</span></span>

- <span data-ttu-id="7d369-224">メディア オープン コールバック</span><span class="sxs-lookup"><span data-stu-id="7d369-224">Media Open callback</span></span>
- <span data-ttu-id="7d369-225">メディア クローズ コールバック</span><span class="sxs-lookup"><span data-stu-id="7d369-225">Media Close callback</span></span>
- <span data-ttu-id="7d369-226">ファイル書き込みコールバック</span><span class="sxs-lookup"><span data-stu-id="7d369-226">File Write callback</span></span>

<span data-ttu-id="7d369-227">登録後は、そのようなイベントが発生すると、これらの関数によってアプリケーションに通知されます。</span><span class="sxs-lookup"><span data-stu-id="7d369-227">After registered, these functions will notify the application when such events occur.</span></span>

## <a name="easy-integration"></a><span data-ttu-id="7d369-228">簡単な統合</span><span class="sxs-lookup"><span data-stu-id="7d369-228">Easy Integration</span></span>

<span data-ttu-id="7d369-229">FileX は、事実上すべての FLASH またはメディア デバイスと簡単に統合できます。</span><span class="sxs-lookup"><span data-stu-id="7d369-229">FileX is easily integrated with virtually any FLASH or media device.</span></span> <span data-ttu-id="7d369-230">FileX の移植は簡単です。</span><span class="sxs-lookup"><span data-stu-id="7d369-230">Porting FileX is simple.</span></span> <span data-ttu-id="7d369-231">このガイドでは、プロセスの詳細について説明します。また、手始めとしては、デモ システムの RAM ドライバーが最適です。</span><span class="sxs-lookup"><span data-stu-id="7d369-231">This guide describes the process in detail, and the RAM driver of the demo system makes for a very good place to start!</span></span>
